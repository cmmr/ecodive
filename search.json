[{"path":[]},{"path":"https://cmmr.github.io/ecodive/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, caste, color, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"https://cmmr.github.io/ecodive/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behavior include: use sexualized language imagery, sexual attention advances kind Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"https://cmmr.github.io/ecodive/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"","what":"Enforcement Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Community leaders responsible clarifying enforcing standards acceptable behavior take appropriate fair corrective action response behavior deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"https://cmmr.github.io/ecodive/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://cmmr.github.io/ecodive/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported community leaders responsible enforcement dansmith01@gmail.com. complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"https://cmmr.github.io/ecodive/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"","what":"Enforcement Guidelines","title":"Contributor Covenant Code of Conduct","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"https://cmmr.github.io/ecodive/CODE_OF_CONDUCT.html","id":"id_1-correction","dir":"","previous_headings":"Enforcement Guidelines","what":"1. Correction","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Use inappropriate language behavior deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behavior inappropriate. public apology may requested.","code":""},{"path":"https://cmmr.github.io/ecodive/CODE_OF_CONDUCT.html","id":"id_2-warning","dir":"","previous_headings":"Enforcement Guidelines","what":"2. Warning","title":"Contributor Covenant Code of Conduct","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behavior. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"https://cmmr.github.io/ecodive/CODE_OF_CONDUCT.html","id":"id_3-temporary-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"3. Temporary Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: serious violation community standards, including sustained inappropriate behavior. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"https://cmmr.github.io/ecodive/CODE_OF_CONDUCT.html","id":"id_4-permanent-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"4. Permanent Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behavior, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"https://cmmr.github.io/ecodive/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 2.1, available https://www.contributor-covenant.org/version/2/1/code_of_conduct.html. Community Impact Guidelines inspired [Mozilla’s code conduct enforcement ladder][https://github.com/mozilla/inclusion]. answers common questions code conduct, see FAQ https://www.contributor-covenant.org/faq. Translations available https://www.contributor-covenant.org/translations.","code":""},{"path":"https://cmmr.github.io/ecodive/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2026 ecodive authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/adiv.html","id":"input-matrix","dir":"Articles","previous_headings":"","what":"Input Matrix","title":"Alpha Diversity","text":"use ex_counts dataset included ecodive. feature table contains counts bacterial genera across various samples.","code":"library(ecodive)  counts <- rarefy(ex_counts) t(counts) #>                   Saliva Gums Nose Stool #> Streptococcus        162  309    6     1 #> Bacteroides            2    2    0   341 #> Corynebacterium        0    0  171     1 #> Haemophilus          180   34    0     1 #> Propionibacterium      1    0   82     0 #> Staphylococcus         0    0   86     1"},{"path":"https://cmmr.github.io/ecodive/articles/adiv.html","id":"alpha-diversity","dir":"Articles","previous_headings":"","what":"Alpha Diversity","title":"Alpha Diversity","text":"Alpha diversity measures diversity within single sample. ecodive, metrics grouped four categories based aspect diversity quantify.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/adiv.html","id":"richness-metrics","dir":"Articles","previous_headings":"Alpha Diversity","what":"Richness Metrics","title":"Alpha Diversity","text":"Richness metrics estimate number distinct features (e.g., genera) sample. simplest metric, observed(), counts features non-zero abundance. Chao1 estimator extends inferring number unobserved, low-abundance features based ratio singletons (counts == 1) doubletons (counts == 2).","code":"# Equivalent to rowSums(counts > 0) observed(counts) #> Saliva   Gums   Nose  Stool  #>      4      3      4      5 # Infers 8 unobserved genera chao1(c(1, 1, 1, 1, 2, 5, 5, 5)) #> [1] 16  # Infers less than 1 unobserved genera chao1(c(1, 2, 2, 2, 2, 5, 5, 5)) #> [1] 8.125  # Datasets without 1s and 2s give Inf or NaN chao1(counts) #> Saliva   Gums   Nose  Stool  #>    4.5    3.0    NaN    Inf"},{"path":"https://cmmr.github.io/ecodive/articles/adiv.html","id":"diversity-metrics","dir":"Articles","previous_headings":"Alpha Diversity","what":"Diversity Metrics","title":"Alpha Diversity","text":"Diversity metrics account richness evenness (equally abundances distributed). Simpson’s index often used measure evenness, representing probability two randomly selected individuals belong different species. Shannon diversity index (entropy) another common metric weights richness evenness.","code":"# High Evenness (0.8) vs Low Evenness (0.07) simpson(c(20, 20, 20, 20, 20)) #> [1] 0.8 simpson(c(100, 1, 1, 1, 1)) #> [1] 0.07507396  # Stool < Gums < Saliva < Nose sort(simpson(counts)) #>      Stool       Gums     Saliva       Nose  #> 0.02302037 0.18806133 0.50725478 0.63539593 # High richness, High evenness shannon(rep(100, 100)) #> [1] 4.60517  # Stool < Gums < Saliva < Nose sort(shannon(counts)) #>      Stool       Gums     Saliva       Nose  #> 0.07927797 0.35692121 0.74119910 1.10615349"},{"path":"https://cmmr.github.io/ecodive/articles/adiv.html","id":"dominance-metrics","dir":"Articles","previous_headings":"Alpha Diversity","what":"Dominance Metrics","title":"Alpha Diversity","text":"Dominance metrics focus abundance common species. Berger-Parker index proportional abundance single abundant feature.","code":"# Stool is dominated by Bacteroides (341/345 counts -> ~0.99) # Nose is more balanced; Corynebacterium is max (171/345 counts -> ~0.49) sort(berger(counts)) #>      Nose    Saliva      Gums     Stool  #> 0.4956522 0.5217391 0.8956522 0.9884058"},{"path":"https://cmmr.github.io/ecodive/articles/adiv.html","id":"phylogenetic-metrics","dir":"Articles","previous_headings":"Alpha Diversity","what":"Phylogenetic Metrics","title":"Alpha Diversity","text":"Phylogenetic metrics use phylogenetic tree incorporate evolutionary distance. Faith’s Phylogenetic Diversity (PD) calculates total branch length spanned features present sample.","code":"# ex_tree: # #       +----------44---------- Haemophilus #   +-2-| #   |   +----------------68---------------- Bacteroides   #   |                       #   |             +---18---- Streptococcus #   |      +--12--|        #   |      |      +--11-- Staphylococcus #   +--11--|               #          |      +-----24----- Corynebacterium #          +--12--| #                 +--13-- Propionibacterium   faith(c(Propionibacterium = 1, Corynebacterium = 1), tree = ex_tree) #> [1] 60  faith(c(Propionibacterium = 1, Haemophilus = 1), tree = ex_tree) #> [1] 82  # Nose < Gums < Saliva < Stool sort(faith(counts, tree = ex_tree)) #>   Nose   Gums Saliva  Stool  #>    101    155    180    202"},{"path":"https://cmmr.github.io/ecodive/articles/adiv.html","id":"formulas","dir":"Articles","previous_headings":"","what":"Formulas","title":"Alpha Diversity","text":"Given: n : Number features (e.g. species, OTUs, ASVs). X_i : Integer count -th feature. X_T : Total counts (sequencing depth). X_T = \\sum_{=1}^{n} X_i P_i : Proportional abundance -th feature. P_i = X_i / X_T F_1 : Number singletons (X_i = 1). F_2 : Number doubletons (X_i = 2).","code":""},{"path":"https://cmmr.github.io/ecodive/articles/adiv.html","id":"abundance-based-coverage-estimator-ace","dir":"Articles","previous_headings":"Formulas","what":"Abundance-based Coverage Estimator (ACE)","title":"Alpha Diversity","text":"Given: r : Rare cutoff (features \\le r counts considered rare). F_{rare} : Number rare features. F_{abund} : Number abundant features (> r counts). X_{rare} : Total counts belonging rare features. C_{ace} : Sample abundance coverage estimator. \\gamma_{ace}^2 : Estimated coefficient variation. C_{ace} = 1 - \\frac{F_1}{X_{rare}} \\gamma_{ace}^2 = \\max\\left[\\frac{F_{rare} \\sum_{=1}^{r}(-1)F_i}{C_{ace}X_{rare}(X_{rare} - 1)} - 1, 0\\right] D_{ace} = F_{abund} + \\frac{F_{rare}}{C_{ace}} + \\frac{F_1}{C_{ace}}\\gamma_{ace}^2","code":""},{"path":"https://cmmr.github.io/ecodive/articles/adiv.html","id":"faiths-phylogenetic-diversity-faiths-pd","dir":"Articles","previous_headings":"Formulas","what":"Faith’s Phylogenetic Diversity (Faith’s PD)","title":"Alpha Diversity","text":"Given n branches lengths L binary vector indicating presence (1) absence (0) descendants branch: \\sum_{= 1}^{n} L_i A_i","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Beta Diversity","text":"Beta diversity measure different two samples . different metrics described vignette quantify difference, referred “distance” “dissimilarity” pair samples. distance typically 0 identical samples 1 completely different samples.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv.html","id":"input-data","dir":"Articles","previous_headings":"Introduction","what":"Input Data","title":"Beta Diversity","text":"use ex_counts feature table included ecodive. contains number observations bacterial genera sample. text , can substitute word ‘genera’ feature interest data. Looking matrix , can see saliva gums similar, saliva stool quite different.","code":"library(ecodive)  counts <- rarefy(ex_counts) t(counts) #>                   Saliva Gums Nose Stool #> Streptococcus        162  309    6     1 #> Bacteroides            2    2    0   341 #> Corynebacterium        0    0  171     1 #> Haemophilus          180   34    0     1 #> Propionibacterium      1    0   82     0 #> Staphylococcus         0    0   86     1"},{"path":"https://cmmr.github.io/ecodive/articles/bdiv.html","id":"weighted-vs-unweighted-metrics","dir":"Articles","previous_headings":"","what":"Weighted vs Unweighted Metrics","title":"Beta Diversity","text":"selecting formula, important distinguish weighted unweighted metrics. Weighted metrics take relative abundances account. Unweighted metrics consider presence/absence (binary data). can consult list_metrics() see category specific metric falls list available options programmatically.","code":"list_metrics('beta', 'id', weighted = FALSE) #> [1] \"sorensen\"  \"hamming\"  \"jaccard\"  \"ochiai\"  \"unweighted_unifrac\"  list_metrics('beta', 'id', weighted = TRUE) #>  [1] \"aitchison\"            \"bhattacharyya\"              \"bray\"                      #>  [4] \"canberra\"             \"chebyshev\"                  \"chord\"                     #>  [7] \"clark\"                \"divergence\"                 \"euclidean\"                 #> [10] \"generalized_unifrac\"  \"gower\"                      \"hellinger\"                 #> [13] \"horn\"                 \"jensen\"                     \"jsd\"                       #> [16] \"lorentzian\"           \"manhattan\"                  \"matusita\"                  #> [19] \"minkowski\"            \"morisita\"                   \"motyka\"                    #> [22] \"normalized_unifrac\"   \"psym_chisq\"                 \"soergel\"                   #> [25] \"squared_chisq\"        \"squared_chord\"              \"squared_euclidean\"         #> [28] \"topsoe\"               \"variance_adjusted_unifrac\"  \"wave_hedges\" #> [31] \"weighted_unifrac\""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv.html","id":"formulas","dir":"Articles","previous_headings":"","what":"Formulas","title":"Beta Diversity","text":"following tables detail mathematical definitions metrics available ecodive.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv.html","id":"abundance-based-weighted","dir":"Articles","previous_headings":"Formulas","what":"Abundance-Based (Weighted)","title":"Beta Diversity","text":"Given: n : number features. X_i, Y_i : Absolute counts -th feature samples X Y. X_T, Y_T : Total counts sample. X_T = \\sum_{=1}^{n} X_i P_i, Q_i : Proportional abundances X_i Y_i. P_i = X_i / X_T X_L, Y_L : Mean log abundances. X_L = \\frac{1}{n}\\sum_{=1}^{n} \\ln{X_i} R_i : range -th feature across samples (max - min).","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv.html","id":"presence-absence-unweighted","dir":"Articles","previous_headings":"Formulas","what":"Presence / Absence (Unweighted)","title":"Beta Diversity","text":"Given: , B : Number features sample. J : Number features common. Note: sorsensen() equivalent bray(norm = 'binary'), jaccard() equivalent soergel(norm = 'binary').","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv.html","id":"phylogenetic","dir":"Articles","previous_headings":"Formulas","what":"Phylogenetic","title":"Beta Diversity","text":"Given n branches lengths L pair samples’ binary (B) proportional abundances (P Q) branches. See https://cmmr.github.io/ecodive/articles/unifrac.html detailed example UniFrac calculations.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv.html","id":"partial-calculation","dir":"Articles","previous_headings":"","what":"Partial Calculation","title":"Beta Diversity","text":"default value pairs=NULL ecodive’s beta diversity functions results returned -vs-distance matrix completely filled . reference-vs-comparison, can use pairs parameter skip unwanted calculations save CPU time. larger dataset, noticeable improvement . pairs argument can : numeric vector, giving positions result calculate. logical vector, indicating whether calculate position result. function(,j) returns whether rows j compared. Therefore, following equivalent: ordering pairs follows pairings produced combn(). , instance, use gums reference sample:","code":"bray(counts) #>          Saliva      Gums      Nose #> Gums  0.4260870                     #> Nose  0.9797101 0.9826087           #> Stool 0.9884058 0.9884058 0.9913043 bray(counts, pairs = 1:3) #>          Saliva      Gums      Nose #> Gums  0.4260870                     #> Nose  0.9797101        NA           #> Stool 0.9884058        NA        NA bray(counts, pairs = 1:3) bray(counts, pairs = c(TRUE, TRUE, TRUE, FALSE, FALSE, FALSE)) bray(counts, pairs = function (i, j) i == 1) # Column index pairings combn(nrow(counts), 2) #>      [,1] [,2] [,3] [,4] [,5] [,6] #> [1,]    1    1    1    2    2    3 #> [2,]    2    3    4    3    4    4  # Sample name pairings combn(rownames(counts), 2) #>      [,1]     [,2]     [,3]     [,4]   [,5]    [,6]    #> [1,] \"Saliva\" \"Saliva\" \"Saliva\" \"Gums\" \"Gums\"  \"Nose\"  #> [2,] \"Gums\"   \"Nose\"   \"Stool\"  \"Nose\" \"Stool\" \"Stool\" my_combn <- combn(rownames(counts), 2) my_pairs <- my_combn[1,] == 'Gums' | my_combn[2,] == 'Gums'  my_pairs #> [1]  TRUE FALSE FALSE  TRUE  TRUE FALSE  bray(counts, pairs = my_pairs) #>          Saliva      Gums      Nose #> Gums  0.4260870                     #> Nose         NA 0.9826087           #> Stool        NA 0.9884058        NA"},{"path":"https://cmmr.github.io/ecodive/articles/bdiv.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Beta Diversity","text":"Levy, ., Shalom, B. R., & Chalamish, M. (2024). guide similarity measures. arXiv. Cha, S.-H. (2007). Comprehensive survey distance/similarity measures probability density functions. International Journal Mathematical Models Methods Applied Sciences, 1(4), 300–307.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv_guide.html","id":"a-practical-guide-to-metric-selection-aligning-method-with-research-question","dir":"Articles","previous_headings":"","what":"A Practical Guide to Metric Selection:Aligning Method with Research Question","title":"Selecting a Beta Diversity Metric","text":"dozens ways measure difference microbial communities (beta diversity), choosing “right” one can feel overwhelming. use UniFrac? Bray-Curtis? Aitchison? good news don’t need master complex mathematics behind every metric make robust choice. (Though want deep dive theory, Gloor et al. (2017) Kers Saccenti (2022) offer excellent open-access reviews data compositionality statistical power). researchers, process relies just key considerations. Instead searching universally “perfect” metric, goal select tool best aligns specific data properties biological hypothesis. vignette cuts noise provide practical decision tree real-world case studies, helping match statistical tools research questions.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv_guide.html","id":"a-decision-tree-for-metric-selection","dir":"Articles","previous_headings":"A Practical Guide to Metric Selection:Aligning Method with Research Question","what":"A Decision Tree for Metric Selection","title":"Selecting a Beta Diversity Metric","text":"decision tree presents series questions help researcher systematically narrow field metrics small, relevant subset.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv_guide.html","id":"do-you-have-a-reliable-phylogenetic-tree-relating-your-taxa-e-g--asvsotus","dir":"Articles","previous_headings":"A Practical Guide to Metric Selection:Aligning Method with Research Question > A Decision Tree for Metric Selection","what":"1. Do you have a reliable phylogenetic tree relating your taxa (e.g., ASVs/OTUs)?","title":"Selecting a Beta Diversity Metric","text":"YES: analysis can likely leverage phylogenetic information. primarily interested presence/absence entire evolutionary lineages (e.g., detecting invasion novel phylum)? -> Start Unweighted UniFrac. described Lozupone & Knight (2005), metric qualitative (binary) measures fraction branch lengths unique one community, making highly sensitive community membership. primarily interested shifts abundance major, well-established lineages (e.g., Firmicutes/Bacteroidetes ratio)? -> Start Weighted UniFrac. metric weights branch lengths abundance, thereby emphasizing dominant taxa minimizing noise rare species. interested robust analysis captures changes across rare, moderate, abundant lineages? -> Use Generalized UniFrac. Simulation studies Chen & Li (2012) demonstrate Generalized UniFrac often provides power detect changes moderately abundant taxa either Unweighted Weighted UniFrac alone. : must use Non-Phylogenetic Metric. Proceed Question 2.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv_guide.html","id":"is-your-data-compositional-i-e--relative-abundances-from-high-throughput-sequencing","dir":"Articles","previous_headings":"A Practical Guide to Metric Selection:Aligning Method with Research Question > A Decision Tree for Metric Selection","what":"2. Is your data compositional (i.e., relative abundances from high-throughput sequencing)?","title":"Selecting a Beta Diversity Metric","text":"YES: must account relative nature data (“constant sum” constraint). statistically rigorous approach use compositional metric. -> primary choice Aitchison distance (Euclidean distance Centered Log-Ratio transformed data). Gloor et al. (2017) argue approach essential avoid spurious correlations “false positives” common standard ecological metrics applied relative abundance data. choose use non-compositional metric, select one robust sparsity. -> Good secondary choices include Hellinger Jensen-Shannon Divergence (JSD). rigorous benchmarking 13 metrics high-dimensional data, Chen et al. (2021) demonstrated Hellinger JSD captured compositional changes low-abundance elements efficiently standard metrics. Similarly, Cordier et al. (2024) found Hellinger one top performers handling noisy, sparse count data. : data represents absolute counts measurements (e.g., microscopy quantitative PCR). Proceed Question 3.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv_guide.html","id":"what-is-the-primary-ecological-signal-you-want-to-detect","dir":"Articles","previous_headings":"A Practical Guide to Metric Selection:Aligning Method with Research Question > A Decision Tree for Metric Selection","what":"3. What is the primary ecological signal you want to detect?","title":"Selecting a Beta Diversity Metric","text":"Presence/Absence specific taxa (Community Membership): interested species present, regardless abundance. -> Choose Qualitative (Binary) Metric. best options Jaccard (standard turnover) Sorensen-Dice. Kers Saccenti (2022) confirm beta diversity metrics focusing membership can reveal differences abundance-weighted metrics miss. Note: cautious sampling depth low; Schroeder et al. (2018) warn richness-based metrics like Jaccard highly sensitive undersampling error. Shifts abundance taxa (Community Structure): interested species dominant abundances change. -> Choose Quantitative Metric. want robust, widely understood standard sensitive dominant taxa -> Use Bray-Curtis. Kers Saccenti (2022) found Bray-Curtis generally sensitive metric observing differences groups. want -weight influence hyper-dominant species -> Use Hellinger distance. noted Chen et al. (2021), metric effectively balances signal dominant rare taxa, avoiding skew common raw abundance metrics.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv_guide.html","id":"case-studies-matching-metrics-to-microbiome-research-questions","dir":"Articles","previous_headings":"A Practical Guide to Metric Selection:Aligning Method with Research Question","what":"Case Studies: Matching Metrics to Microbiome Research Questions","title":"Selecting a Beta Diversity Metric","text":"following case studies illustrate choice metric directly influences ability answer specific biological question.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv_guide.html","id":"case-study-1-does-antibiotic-treatment-eliminate-specific-rare-potentially-pathogenic-taxa","dir":"Articles","previous_headings":"A Practical Guide to Metric Selection:Aligning Method with Research Question > Case Studies: Matching Metrics to Microbiome Research Questions","what":"Case Study 1: Does antibiotic treatment eliminate specific rare, potentially pathogenic taxa?","title":"Selecting a Beta Diversity Metric","text":"Research Question: question explicitly presence absence key organisms (membership). massive shifts abundant commensal bacteria secondary. Recommended Metric: Jaccard Unweighted UniFrac. Justification: quantitative metric like Bray-Curtis dominated large-scale disruption dominant taxa. signal rare pathogen’s disappearance lost. demonstrated Lozupone & Knight (2005), Unweighted UniFrac treats unique evolutionary history pathogen significant event, directly addressing research question.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv_guide.html","id":"case-study-2-how-does-a-high-fiber-vs--high-fat-diet-alter-the-overall-gut-microbiome-structure","dir":"Articles","previous_headings":"A Practical Guide to Metric Selection:Aligning Method with Research Question > Case Studies: Matching Metrics to Microbiome Research Questions","what":"Case Study 2: How does a high-fiber vs. high-fat diet alter the overall gut microbiome structure?","title":"Selecting a Beta Diversity Metric","text":"Research Question: question concerns broad, systemic shifts community’s metabolic capacity (abundance major guilds). Recommended Metrics: Bray-Curtis Hellinger. Justification: Bray-Curtis sensitive shifts dominant taxa. However, Kers Saccenti (2022) recommend checking results across multiple metrics ensure robustness. Chen et al. (2021) specifically highlight Hellinger’s ability handle sparsity skew microbiome data better simple Euclidean distances.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/bdiv_guide.html","id":"case-study-3-comparing-gut-communities-with-vastly-different-dominant-phyla-e-g--bacteroidetes-dominant-vs--firmicutes-dominant-","dir":"Articles","previous_headings":"A Practical Guide to Metric Selection:Aligning Method with Research Question > Case Studies: Matching Metrics to Microbiome Research Questions","what":"Case Study 3: Comparing gut communities with vastly different dominant phyla (e.g., Bacteroidetes-dominant vs. Firmicutes-dominant).","title":"Selecting a Beta Diversity Metric","text":"Research Question: goal understand structural differences beyond obvious phylum-level dominance. Recommended Metric: Aitchison distance. Justification: compositionality problem. Bray-Curtis analysis, massive difference dominant phylum obscure variation. Gloor et al. (2017) demonstrate Aitchison distance uses log-ratios normalize dominant components, allowing researcher investigate “sub-compositional” structure. Content generated Google Gemini. Verified formatted Daniel Smith. January 27th, 2026.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/articles/benchmark.html","id":"state-of-the-field","dir":"Articles","previous_headings":"Introduction","what":"State of the Field","title":"Benchmarks","text":"analysis provides comparative benchmark R packages designed calculating standard phylogenetic metrics alpha beta diversity. primary objective evaluate computational efficiency, focus processing speed memory allocation. Packages rely foundational libraries dependencies omitted study isolate performance core implementations.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/benchmark.html","id":"methodology","dir":"Articles","previous_headings":"Introduction","what":"Methodology","title":"Benchmarks","text":"bench R package employed quantify computational runtime memory allocation diversity algorithms within 15 selected packages. benchmarks executed host system following hardware software configuration: Furthermore, bench::mark() function utilized verify outputs benchmarked expressions numerically equivalent, ensuring consistency comparability results.","code":"CPU: 6-Core Intel i5-9600K @ 3.70GHz RAM: 64.0 GB OS: Windows 11 Pro (64-bit, Version 25H2, Build 26200.7171)"},{"path":"https://cmmr.github.io/ecodive/articles/benchmark.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Benchmarks","text":"Two standard datasets rbiom R package, hmp50 gems, selected evaluation. hmp50 dataset, includes 50 samples associated phylogenetic tree, used benchmark computationally intensive phylogenetic metrics, UniFrac Faith’s PD. traditional diversity metrics, significantly less demanding, larger gems dataset, comprising 1,006 samples, employed. account heterogeneous input output formats across 15 R packages, necessary data transformations performed. ensure benchmarks exclusively measured performance diversity calculations, data conversion steps executed outside timed code blocks whenever possible.","code":"install.packages('pak')  # Tools and Datasets for Benchmarking Report pak::pkg_install(pkg = c(   'bench', 'dplyr', 'ggplot2', 'ggrepel', 'rbiom', 'svglite' ))  # Diversity Metric Implementations pak::pkg_install(pkg = c(   'abdiv', 'adiv', 'ecodist', 'ecodive', 'entropart', 'GUniFrac',    'kasperskytte/ampvis2', 'labdsv', 'parallelDist', 'philentropy',    'phyloregion', 'phyloseq', 'picante', 'tabula', 'vegan' ))   # Software Versions  version$version.string #> [1] \"R version 4.5.2 (2025-10-31 ucrt)\"  data.frame(ver = sapply(FUN = packageDescription, fields = 'Version', c(   'bench', 'dplyr', 'ggplot2', 'ggrepel', 'rbiom',   'abdiv', 'adiv', 'ecodist', 'ecodive', 'entropart', 'GUniFrac',    'ampvis2', 'labdsv', 'parallelDist', 'philentropy',    'phyloregion', 'phyloseq', 'picante', 'tabula', 'vegan' ))) #>                 ver #> bench         1.1.4 #> dplyr         1.1.4 #> ggplot2       4.0.1 #> ggrepel       0.9.6 #> rbiom         2.2.1 #> abdiv         0.2.0 #> adiv          2.2.1 #> ecodist       2.1.3 #> ecodive       2.2.0 #> entropart    1.6-16 #> GUniFrac        1.9 #> ampvis2      2.8.11 #> labdsv        2.1-2 #> parallelDist  0.2.7 #> philentropy  0.10.0 #> phyloregion   1.0.9 #> phyloseq     1.54.0 #> picante       1.8.2 #> tabula        3.3.2 #> vegan         2.7-2  library(bench) library(ggplot2) library(ggrepel) library(dplyr) library(Matrix)  (n_cpus <- ecodive::n_cpus()) #> [1] 6  # abdiv only accepts two samples at a time pairwise <- function (f, data, ...) {   pairs <- utils::combn(nrow(data), 2)   structure(     mapply(       FUN = function (i, j) f(data[i,], data[j,], ...),        i   = pairs[1,], j = pairs[2,] ),     class  = 'dist',     Labels = rownames(data),     Size   = nrow(data),     Diag   = FALSE,     Upper  = FALSE ) }   # Remove any extraneous attributes from dist objects, # allowing them to be compared with `all.equal()`. cleanup <- function (x) {   for (i in setdiff(names(attributes(x)), c('class', 'Labels', 'Size', 'Diag', 'Upper')))     attr(x, i) <- NULL   return (x) }   # HMP50 dataset has 50 samples; convert to relative abundances hmp50       <- rbiom::hmp50 hmp50_phy   <- rbiom::convert_to_phyloseq(hmp50) hmp50_mtx   <- t(apply(as.matrix(hmp50), 2L, function (x) x / sum(x))) hmp50_mtx_t <- t(hmp50_mtx) hmp50_dgC   <- as(hmp50_mtx, 'dgCMatrix') hmp50_dgC_t <- t(hmp50_dgC) hmp50_tree  <- hmp50$tree   # GEMS dataset has 1006 samples; convert to relative abundances gems_mtx   <- t(apply(as.matrix(rbiom::gems), 2L, function (x) x / sum(x))) gems_dgC   <- as(gems_mtx, 'dgCMatrix') gems_dgC_t <- t(gems_dgC)  ## Bray-Curtis Dissimilarity bray_curtis_res <- bench::mark(   iterations = 10,   'abdiv'        = cleanup(pairwise(abdiv::bray_curtis, gems_mtx)),   'ecodist'      = cleanup(ecodist::bcdist(gems_mtx)),   'ecodive'      = cleanup(ecodive::bray(gems_dgC_t, norm = 'none', margin = 2)),   'labdsv'       = cleanup(labdsv::dsvdis(gems_mtx, 'bray/curtis')),   'parallelDist' = cleanup(parallelDist::parallelDist(gems_mtx, 'bray')),   'philentropy'  = cleanup(philentropy::distance(gems_mtx, 'sorensen', test.na = FALSE, use.row.names = TRUE, as.dist.obj = TRUE, mute.message = TRUE)),   'tabula'       = cleanup(1 - pairwise(tabula::index_bray, gems_mtx)),   'vegan'        = cleanup(vegan::vegdist(gems_mtx, 'bray')) )   ## Jaccard Distance jaccard_res <- bench::mark(   iterations = 10,   'abdiv'        = cleanup(pairwise(abdiv::jaccard, gems_mtx)),   'ecodist'      = cleanup(ecodist::distance(gems_mtx, 'jaccard')),   'ecodive'      = cleanup(ecodive::jaccard(gems_dgC_t, margin = 2)),   'parallelDist' = cleanup(parallelDist::parallelDist(gems_mtx, 'binary')),   'philentropy'  = cleanup(philentropy::distance(gems_mtx > 0, 'jaccard', test.na = FALSE, use.row.names = TRUE, as.dist.obj = TRUE, mute.message = TRUE)),   'phyloregion'  = cleanup(phyloregion::beta_diss(gems_mtx, 'jaccard')$beta.jac),   'stats'        = cleanup(stats::dist(gems_mtx, 'binary')),   'vegan'        = cleanup(vegan::vegdist(gems_mtx, 'jaccard', binary = TRUE)) )   ## Manhattan Distance manhattan_res <- bench::mark(   iterations = 10,   'abdiv'        = cleanup(pairwise(abdiv::manhattan, gems_mtx)),   'ecodist'      = cleanup(ecodist::distance(gems_mtx, 'manhattan')),   'ecodive'      = cleanup(ecodive::manhattan(gems_dgC_t, norm = 'none', margin = 2)),   'parallelDist' = cleanup(parallelDist::parallelDist(gems_mtx, 'manhattan')),   'philentropy'  = cleanup(philentropy::distance(gems_mtx, 'manhattan', test.na = FALSE, use.row.names = TRUE, as.dist.obj = TRUE, mute.message = TRUE)),   'stats'        = cleanup(stats::dist(gems_mtx, 'manhattan')),   'vegan'        = cleanup(vegan::vegdist(gems_mtx, 'manhattan')) )   ## Euclidean Distance euclidean_res <- bench::mark(   iterations = 10,   'abdiv'        = cleanup(pairwise(abdiv::euclidean, gems_mtx)),   'ecodist'      = cleanup(ecodist::distance(gems_mtx, 'euclidean')),   'ecodive'      = cleanup(ecodive::euclidean(gems_dgC_t, norm = 'none', margin = 2)),   'parallelDist' = cleanup(parallelDist::parallelDist(gems_mtx, 'euclidean')),   'philentropy'  = cleanup(philentropy::distance(gems_mtx, 'euclidean', test.na = FALSE, use.row.names = TRUE, as.dist.obj = TRUE, mute.message = TRUE)),   'stats'        = cleanup(stats::dist(gems_mtx, 'euclidean')),   'vegan'        = cleanup(vegan::vegdist(gems_mtx, 'euclidean')) )   ## Shannon Diversity Index shannon_res <- bench::mark(   iterations  = 10,   'abdiv'       = apply(gems_mtx, 1L, abdiv::shannon),   'adiv'        = adiv::speciesdiv(gems_mtx, 'Shannon')[,1],   'ecodive'     = ecodive::shannon(gems_dgC_t, margin = 2),   'entropart'   = apply(gems_mtx, 1L, entropart::Shannon, CheckArguments = FALSE),   'philentropy' = apply(gems_mtx, 1L, philentropy::H, unit = 'log'),   'tabula'      = apply(gems_mtx, 1L, tabula::index_shannon),   'vegan'       = vegan::diversity(gems_mtx, 'shannon') )   ## Gini-Simpson Index simpson_res <- bench::mark(   iterations  = 10,   'abdiv'     = apply(gems_mtx, 1L, abdiv::simpson),   'adiv'      = adiv::speciesdiv(gems_mtx, 'GiniSimpson')[,1],   'ecodive'   = ecodive::simpson(gems_dgC_t, margin = 2),   'entropart' = apply(gems_mtx, 1L, entropart::Simpson, CheckArguments = FALSE),   'tabula'    = 1 - apply(gems_mtx, 1L, tabula::index_simpson),   'vegan'     = vegan::diversity(gems_mtx, 'simpson') )   ## Faith's Phylogenetic Diversity faith_res <- bench::mark(   iterations    = 10,   check         = FALSE, # entropart has incorrect output on non-ultrametric tree   'abdiv'       = apply(hmp50_mtx, 1L, abdiv::faith_pd, hmp50_tree),   'adiv'        = apply(hmp50_mtx, 1L, \\(x) adiv::EH(hmp50_tree, colnames(hmp50_mtx)[x > 0])),   'ecodive'     = ecodive::faith(hmp50_dgC_t, hmp50_tree, margin = 2),   'entropart'   = apply(hmp50_mtx, 1L, entropart::PDFD, hmp50_tree, CheckArguments = FALSE),   'phyloregion' = phyloregion::PD(hmp50_mtx, hmp50_tree),   'picante'     = as.matrix(picante::pd(hmp50_mtx, hmp50_tree))[,'PD'] )   ## Unweighted UniFrac u_unifrac_res <- rbind(      local({     # cluster for phyloseq     cl <- parallel::makeCluster(n_cpus)     doParallel::registerDoParallel(cl)     on.exit(parallel::stopCluster(cl))          bench::mark(       iterations    = 10,       'abdiv'       = cleanup(pairwise(abdiv::unweighted_unifrac, hmp50_mtx, hmp50_tree)),       'ecodive'     = cleanup(ecodive::unweighted_unifrac(hmp50_dgC_t, hmp50_tree, margin = 2)),       'GUniFrac'    = cleanup(as.dist(GUniFrac::GUniFrac(hmp50_mtx, hmp50_tree, alpha=1, verbose=FALSE)[[1]][,,2])),       'phyloregion' = cleanup(phyloregion::unifrac(hmp50_dgC, hmp50_tree)),       'phyloseq'    = cleanup(phyloseq::UniFrac(hmp50_phy, weighted=FALSE, normalized=FALSE, parallel=TRUE)),       'picante'     = cleanup(picante::unifrac(hmp50_mtx, hmp50_tree)) )   }),      # ampvis2 conflicts with phyloseq cluster, so run separately   local({     bench::mark(       iterations = 10,       'ampvis2'  = {         cleanup(ampvis2:::dist.unifrac(hmp50_mtx_t, hmp50_tree, weighted=FALSE, normalise=FALSE, num_threads=n_cpus))         doParallel::stopImplicitCluster() } )   }) )   ## Weighted UniFrac w_unifrac_res <- rbind(      local({     # cluster for phyloseq     cl <- parallel::makeCluster(n_cpus)     doParallel::registerDoParallel(cl)     on.exit(parallel::stopCluster(cl))          bench::mark(       iterations = 10,       'abdiv'    = cleanup(pairwise(abdiv::weighted_unifrac, hmp50_mtx, hmp50_tree)),       'ecodive'  = cleanup(ecodive::weighted_unifrac(hmp50_dgC_t, hmp50_tree, margin = 2)),       'phyloseq' = cleanup(phyloseq::UniFrac(hmp50_phy, weighted=TRUE, normalized=FALSE, parallel=TRUE)) )   }),      # ampvis2 conflicts with phyloseq cluster, so run separately   local({     bench::mark(       iterations = 10,       'ampvis2'  = {         cleanup(ampvis2:::dist.unifrac(hmp50_mtx_t, hmp50_tree, weighted=TRUE, normalise=FALSE, num_threads=n_cpus))         doParallel::stopImplicitCluster() } )   }) )   ## Weighted Normalized UniFrac wn_unifrac_res <- rbind(      local({     # cluster for phyloseq     cl <- parallel::makeCluster(n_cpus)     doParallel::registerDoParallel(cl)     on.exit(parallel::stopCluster(cl))          bench::mark(       iterations = 10,       'abdiv'    = cleanup(pairwise(abdiv::weighted_normalized_unifrac, hmp50_mtx, hmp50_tree)),       'ecodive'  = cleanup(ecodive::normalized_unifrac(hmp50_dgC_t, hmp50_tree, margin = 2)),       'GUniFrac' = cleanup(as.dist(GUniFrac::GUniFrac(hmp50_mtx, hmp50_tree, alpha=1, verbose=FALSE)[[1]][,,1])),       'phyloseq' = cleanup(phyloseq::UniFrac(hmp50_phy, weighted=TRUE, normalized=TRUE, parallel=TRUE)) )   }),      # ampvis2 conflicts with phyloseq cluster, so run separately   local({     bench::mark(       iterations = 10,       'ampvis2'  = {         cleanup(ampvis2:::dist.unifrac(hmp50_mtx_t, hmp50_tree, weighted=TRUE, normalise=TRUE, num_threads=n_cpus))         doParallel::stopImplicitCluster() } )   }) )   ## Weighted Normalized UniFrac g_unifrac_res <- rbind(      local({     # cluster for phyloseq     cl <- parallel::makeCluster(n_cpus)     doParallel::registerDoParallel(cl)     on.exit(parallel::stopCluster(cl))          bench::mark(       iterations = 10,       'abdiv'    = cleanup(pairwise(abdiv::generalized_unifrac, hmp50_mtx, hmp50_tree, alpha=0.5)),       'ecodive'  = cleanup(ecodive::generalized_unifrac(hmp50_dgC_t, hmp50_tree, margin=2, alpha=0.5)),       'GUniFrac' = cleanup(as.dist(GUniFrac::GUniFrac(hmp50_mtx, hmp50_tree, alpha=0.5, verbose=FALSE)[[1]][,,1])) )   }) )   ## Variance Adjusted UniFrac va_unifrac_res <- rbind(      local({     # cluster for phyloseq     cl <- parallel::makeCluster(n_cpus)     doParallel::registerDoParallel(cl)     on.exit(parallel::stopCluster(cl))          bench::mark(       iterations = 10,       'abdiv'    = cleanup(pairwise(abdiv::variance_adjusted_unifrac, hmp50_mtx, hmp50_tree)),       'ecodive'  = cleanup(ecodive::variance_adjusted_unifrac(hmp50_dgC_t, hmp50_tree, margin = 2)) )   }) )     ## Data frame for Figure 1A Fig1A_data <- bind_rows(     mutate(bray_curtis_res, Metric = 'bray'),     mutate(shannon_res,     Metric = 'shannon'),     mutate(faith_res,       Metric = 'faith') ) %>%   mutate(Package = as.character(expression)) %>%   select(Package, Metric, median, mem_alloc) %>%   arrange(Metric, median)  Fig1A_data$Title <- factor(   x      = Fig1A_data$Metric,    levels = c(\"shannon\", \"bray\", \"faith\"),    labels = c(     \"**Shannon Diversity Index**<br>1006 samples\",      \"**Bray-Curtis Dissimilarity**<br>1006 samples\",      \"**Faith's Phylogenetic Diversity**<br>50 samples\") )   ## ggplot for Figure 1A Fig1A <- ggplot(Fig1A_data, aes(x = median, y = mem_alloc)) +     facet_wrap('Title', nrow = 1, scales = 'free_x') +      geom_point() +     geom_label_repel(aes(         label    = Package,         alpha    = ifelse(Package == 'ecodive', 1, 0.6),         fontface = ifelse(Package == 'ecodive', 2, 1),         size     = ifelse(Package == 'ecodive', 3.2, 3) ),        box.padding        = .4,       point.padding      = .5,       min.segment.length = 0 ) +      scale_alpha_identity(guide = 'none') +     scale_size_identity(guide = 'none') +     bench::scale_x_bench_time() +     scale_y_log10(labels = scales::label_bytes()) +     labs(       tag = 'A',       x   = 'Median Calculation Time (log scale; n=10)',        y   = 'Memory Allocated\\n(log scale; n=1)' ) +     theme_bw(base_size = 12) +     theme(       strip.text   = ggtext::element_markdown(hjust = 0, lineheight = 1.2),       axis.title.x = element_text(margin = margin(t = 10)))         ## Data frame for Figure 1B Fig1B_data <- bind_rows(     mutate(u_unifrac_res,  `UniFrac Variant` = 'Unweighted'),     mutate(w_unifrac_res,  `UniFrac Variant` = 'Weighted'),     mutate(wn_unifrac_res, `UniFrac Variant` = 'Weighted Normalized'),     mutate(g_unifrac_res,  `UniFrac Variant` = 'Generalized'),     mutate(va_unifrac_res, `UniFrac Variant` = 'Variance Adjusted') ) %>%   mutate(Package = as.character(expression)) %>%   select(Package, `UniFrac Variant`, median, mem_alloc) %>%   arrange(Package)  Fig1B_data$Title <- \"**UniFrac Family**<br>50 samples\" Fig1B_data$`UniFrac Variant` <- factor(   x      = Fig1B_data$`UniFrac Variant`,    levels = c(\"Unweighted\", \"Weighted\", \"Weighted Normalized\", \"Generalized\", \"Variance Adjusted\") )   ## ggplot for Figure 1B Fig1B <- ggplot(Fig1B_data, aes(x = median, y = mem_alloc)) +   facet_wrap('Title') +    geom_point(aes(shape = `UniFrac Variant`), size = 2) +   geom_label_repel(aes(       label    = Package,        alpha    = ifelse(Package == 'ecodive', 1, 0.6),       fontface = ifelse(Package == 'ecodive', 2, 1),       size     = ifelse(Package == 'ecodive', 3.2, 3) ),     data          = ~subset(., `UniFrac Variant` == 'Unweighted'),     direction     = 'y',      box.padding   = 0.4,     point.padding = 10,     min.segment.length = Inf ) +    scale_shape(solid = FALSE) +    scale_alpha_identity(guide = 'none') +   scale_size_identity(guide = 'none') +   bench::scale_x_bench_time() +   scale_y_log10(labels = scales::label_bytes()) +   labs(     tag = 'B',     x   = 'Median Calculation Time (log scale; n=10)',      y   = 'Memory Allocated\\n(log scale; n=1)' ) +   theme_bw(base_size = 12) +   theme(     strip.text   = ggtext::element_markdown(hjust = 0, lineheight = 1.2),     axis.title.x = element_text(margin = margin(t = 10)) )   ## Combined Figure 1 Fig1 <- patchwork::wrap_plots(   Fig1A,    Fig1B,    patchwork::guide_area(),    design = \"111\\n223\",    guides = 'collect' )"},{"path":"https://cmmr.github.io/ecodive/articles/benchmark.html","id":"results","dir":"Articles","previous_headings":"","what":"Results","title":"Benchmarks","text":"","code":"print(Fig1)"},{"path":"https://cmmr.github.io/ecodive/articles/benchmark.html","id":"how-much-faster-and-more-memory-efficient-is-ecodive","dir":"Articles","previous_headings":"Results","what":"How much faster and more memory efficient is ecodive?","title":"Benchmarks","text":"","code":"plyr::ddply(Fig1A_data, as.name('Metric'), function (x) {   x[['median']]    <- as.numeric(x[['median']])   x[['mem_alloc']] <- as.numeric(x[['mem_alloc']])   ecodive <- as.list(x[x[['Package']] == 'ecodive',])   x       <- x[x[['Package']] != 'ecodive',]   data.frame(     speed  = paste0(paste(collapse=' - ', round(range(x$median    / ecodive$median))), 'x'),     memory = paste0(paste(collapse=' - ', round(range(x$mem_alloc / ecodive$mem_alloc))), 'x') ) })  #>    Metric      speed        memory #> 1    bray  8 - 1259x     2 - 5272x #> 2   faith  1 - 9290x  168 - 58964x #> 3 shannon   3 - 159x  1849 - 8261x   plyr::ddply(Fig1B_data, as.name('UniFrac Variant'), function (x) {   x[['median']]    <- as.numeric(x[['median']])   x[['mem_alloc']] <- as.numeric(x[['mem_alloc']])   ecodive <- as.list(x[x[['Package']] == 'ecodive',])   x       <- x[x[['Package']] != 'ecodive',]   data.frame(     speed  = paste0(paste(collapse=' - ', round(range(x$median    / ecodive$median))), 'x'),     memory = paste0(paste(collapse=' - ', round(range(x$mem_alloc / ecodive$mem_alloc))), 'x') ) }) #>       UniFrac Variant         speed            memory #> 1          Unweighted     1 - 2264x       74 - 29695x #> 2            Weighted    45 - 2019x     421 - 175550x #> 3 Weighted Normalized    12 - 2138x     422 - 175629x #> 4         Generalized    10 - 1818x     673 - 151011x #> 5   Variance Adjusted  2314 - 2314x  216462 - 216462x"},{"path":"https://cmmr.github.io/ecodive/articles/benchmark.html","id":"raw-data-for-figure-1-panel-a","dir":"Articles","previous_headings":"Results","what":"Raw Data for Figure 1 Panel A","title":"Benchmarks","text":"","code":"print(Fig1A_data[,1:4], n = Inf) #> # A tibble: 21 × 4 #>    Package      Metric    median mem_alloc #>    <chr>        <chr>   <bch:tm> <bch:byt> #>  1 ecodive      bray     19.54ms    3.97MB #>  2 philentropy  bray    150.69ms   38.87MB #>  3 parallelDist bray    187.98ms    7.88MB #>  4 ecodist      bray    399.37ms   29.45MB #>  5 labdsv       bray    723.36ms   68.16MB #>  6 vegan        bray       1.68s   16.45MB #>  7 abdiv        bray      13.68s   20.43GB #>  8 tabula       bray      24.59s   20.44GB #>  9 phyloregion  faith      3.1ms  145.18MB #> 10 ecodive      faith     3.14ms  425.89KB #> 11 picante      faith    83.91ms   69.86MB #> 12 abdiv        faith   624.58ms  651.74MB #> 13 adiv         faith      2.03s  562.76MB #> 14 entropart    faith     29.13s   23.95GB #> 15 ecodive      shannon   8.19ms    15.6KB #> 16 tabula       shannon  24.41ms   28.17MB #> 17 entropart    shannon  36.85ms   41.77MB #> 18 adiv         shannon  38.68ms  125.87MB #> 19 vegan        shannon  58.97ms   68.08MB #> 20 abdiv        shannon  65.92ms   95.38MB #> 21 philentropy  shannon     1.3s   52.67MB"},{"path":"https://cmmr.github.io/ecodive/articles/benchmark.html","id":"raw-data-for-figure-1-panel-b","dir":"Articles","previous_headings":"Results","what":"Raw Data for Figure 1 Panel B","title":"Benchmarks","text":"","code":"print(Fig1B_data[,1:4], n = Inf) #> # A tibble: 21 × 4 #>    Package     `UniFrac Variant`     median mem_alloc #>    <chr>       <fct>               <bch:tm> <bch:byt> #>  1 GUniFrac    Unweighted           77.53ms   113.4MB #>  2 GUniFrac    Weighted Normalized  88.74ms    92.1MB #>  3 GUniFrac    Generalized          80.09ms    92.1MB #>  4 abdiv       Unweighted             14.5s    20.1GB #>  5 abdiv       Weighted              15.74s      20GB #>  6 abdiv       Weighted Normalized   16.17s      20GB #>  7 abdiv       Generalized           15.01s    20.2GB #>  8 abdiv       Variance Adjusted        17s    24.5GB #>  9 ampvis2     Unweighted             3.47s    53.5MB #> 10 ampvis2     Weighted               4.48s    49.2MB #> 11 ampvis2     Weighted Normalized    4.34s    49.3MB #> 12 ecodive     Unweighted             6.4ms   708.2KB #> 13 ecodive     Weighted               7.8ms   119.6KB #> 14 ecodive     Weighted Normalized   7.56ms   119.6KB #> 15 ecodive     Generalized           8.26ms   140.2KB #> 16 ecodive     Variance Adjusted     7.35ms   118.5KB #> 17 phyloregion Unweighted            6.27ms   149.5MB #> 18 phyloseq    Unweighted          297.66ms    50.9MB #> 19 phyloseq    Weighted            352.09ms    49.4MB #> 20 phyloseq    Weighted Normalized 415.88ms    49.5MB #> 21 picante     Unweighted             2.54s     1.8GB"},{"path":"https://cmmr.github.io/ecodive/articles/ecodive.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction to ecodive","text":"Ecodive calculates ecological diversity metrics. Alpha diversity metrics provide insight single sample’s diversity, whereas beta diversity metrics indicate different pair samples . guide, ’ll use ex_counts dataset included ecodive. ex_counts feature table enumerates many times bacterial genera observed different body sites. example, ‘features’ feature table genera. However, dataset can use whatever feature makes sense - species, OTUs, ASVs, even something completely unrelated ecology.","code":"library(ecodive)  t(ex_counts) #>                   Saliva Gums Nose Stool #> Streptococcus        162  793   22     1 #> Bacteroides            2    4    2   611 #> Corynebacterium        0    0  498     1 #> Haemophilus          180   87    2     1 #> Propionibacterium      1    1  251     0 #> Staphylococcus         0    1  236     1"},{"path":"https://cmmr.github.io/ecodive/articles/ecodive.html","id":"alpha-diversity","dir":"Articles","previous_headings":"","what":"Alpha Diversity","title":"Introduction to ecodive","text":"Alpha diversity metrics describe many different genera present sample. Depending metric, can take account number unique genera (richness), evenly population split among genera (evenness), distantly related genera (phylogenetic diversity). available alpha diversity metrics can listed using list_metrics(). reading: vignette('adiv')","code":"list_metrics('alpha')[,1:5] #>                                        name          id phylo weighted int_only #> 1  Abundance-based Coverage Estimator (ACE)         ace FALSE     TRUE     TRUE #> 3                       Berger-Parker Index      berger FALSE     TRUE    FALSE #> 6                           Brillouin Index   brillouin FALSE     TRUE     TRUE #> 8                                     Chao1       chao1 FALSE     TRUE     TRUE #> 15           Faith's Phylogenetic Diversity       faith  TRUE    FALSE    FALSE #> 16                           Fisher's Alpha      fisher FALSE     TRUE     TRUE #> 18                       Gini-Simpson Index     simpson FALSE     TRUE    FALSE #> 23                    Inverse Simpson Index inv_simpson FALSE     TRUE    FALSE #> 29                Margalef's Richness Index    margalef FALSE     TRUE     TRUE #> 31                           McIntosh Index    mcintosh FALSE     TRUE     TRUE #> 32               Menhinick's Richness Index   menhinick FALSE     TRUE     TRUE #> 37                        Observed Features    observed FALSE    FALSE    FALSE #> 40                  Shannon Diversity Index     shannon FALSE     TRUE    FALSE #> 45               Squares Richness Estimator     squares FALSE     TRUE     TRUE"},{"path":"https://cmmr.github.io/ecodive/articles/ecodive.html","id":"beta-diversity","dir":"Articles","previous_headings":"","what":"Beta Diversity","title":"Introduction to ecodive","text":"Beta diversity metrics describe different two samples , based genera observed .UniFrac metrics incorporate phylogenetic tree calculation. available alpha diversity metrics can listed using list_metrics().","code":"list_metrics('beta')[,2:6] #>                           id phylo weighted int_only true_metric #> 2                  aitchison FALSE     TRUE    FALSE        TRUE #> 4              bhattacharyya FALSE     TRUE    FALSE        TRUE #> 5                       bray FALSE     TRUE    FALSE       FALSE #> 7                   canberra FALSE     TRUE    FALSE        TRUE #> 9                  chebyshev FALSE     TRUE    FALSE        TRUE #> 10                     chord FALSE     TRUE    FALSE        TRUE #> 11                     clark FALSE     TRUE    FALSE        TRUE #> 12                  sorensen FALSE    FALSE    FALSE       FALSE #> 13                divergence FALSE     TRUE    FALSE        TRUE #> 14                 euclidean FALSE     TRUE    FALSE        TRUE #> 17       generalized_unifrac  TRUE     TRUE    FALSE        TRUE #> 19                     gower FALSE     TRUE    FALSE        TRUE #> 20                   hamming FALSE    FALSE    FALSE        TRUE #> 21                 hellinger FALSE     TRUE    FALSE        TRUE #> 22                      horn FALSE     TRUE    FALSE       FALSE #> 24                   jaccard FALSE    FALSE    FALSE        TRUE #> 25                    jensen FALSE     TRUE    FALSE        TRUE #> 26                       jsd FALSE     TRUE    FALSE        TRUE #> 27                lorentzian FALSE     TRUE    FALSE       FALSE #> 28                 manhattan FALSE     TRUE    FALSE        TRUE #> 30                  matusita FALSE     TRUE    FALSE        TRUE #> 33                 minkowski FALSE     TRUE    FALSE        TRUE #> 34                  morisita FALSE     TRUE     TRUE       FALSE #> 35                    motyka FALSE     TRUE    FALSE       FALSE #> 36        normalized_unifrac  TRUE     TRUE    FALSE        TRUE #> 38                    ochiai FALSE    FALSE    FALSE       FALSE #> 39                psym_chisq FALSE     TRUE    FALSE       FALSE #> 41                   soergel FALSE     TRUE    FALSE        TRUE #> 42             squared_chisq FALSE     TRUE    FALSE       FALSE #> 43             squared_chord FALSE     TRUE    FALSE       FALSE #> 44         squared_euclidean FALSE     TRUE    FALSE       FALSE #> 46                    topsoe FALSE     TRUE    FALSE        TRUE #> 47        unweighted_unifrac  TRUE     TRUE    FALSE        TRUE #> 48 variance_adjusted_unifrac  TRUE     TRUE    FALSE        TRUE #> 49               wave_hedges FALSE     TRUE    FALSE       FALSE #> 50          weighted_unifrac  TRUE     TRUE    FALSE        TRUE"},{"path":[]},{"path":"https://cmmr.github.io/ecodive/articles/ecodive.html","id":"rarefaction","dir":"Articles","previous_headings":"Example","what":"Rarefaction","title":"Introduction to ecodive","text":"ex_counts feature table 345 saliva observations, nose 1011 observations. unequal sampling depth can cause systematic biases. Specifically, rare genera observed often samples greater sampling depths, thereby artificially inflating observed richness. first step rarefy ex_counts samples number observations. Rarefying randomly removes observations samples observations.","code":"rowSums(ex_counts) #> Saliva   Gums   Nose  Stool  #>    345    886   1011    615   counts <- rarefy(ex_counts)  rowSums(counts) #> Saliva   Gums   Nose  Stool  #>    345    345    345    345   t(counts) #>                   Saliva Gums Nose Stool #> Streptococcus        162  309    6     1 #> Bacteroides            2    2    0   341 #> Corynebacterium        0    0  171     1 #> Haemophilus          180   34    0     1 #> Propionibacterium      1    0   82     0 #> Staphylococcus         0    0   86     1"},{"path":"https://cmmr.github.io/ecodive/articles/ecodive.html","id":"classic-metrics","dir":"Articles","previous_headings":"Example","what":"Classic Metrics","title":"Introduction to ecodive","text":"alpha beta diversity metrics around 50+ years don’t require phylogenetic tree. beta diversity functions can take weighted = FALSE argument use presence/absence information instead relative abundances.","code":"## Alpha Diversity -------------------  shannon(counts) #>     Saliva       Gums       Nose      Stool  #> 0.74119910 0.35692121 1.10615349 0.07927797    ## Beta Diversity --------------------  bray(counts) #>          Saliva      Gums      Nose #> Gums  0.4260870                     #> Nose  0.9797101 0.9826087           #> Stool 0.9884058 0.9884058 0.9913043"},{"path":"https://cmmr.github.io/ecodive/articles/ecodive.html","id":"phylogenetic-metrics","dir":"Articles","previous_headings":"Example","what":"Phylogenetic Metrics","title":"Introduction to ecodive","text":"phylogenetic tree enables alpha beta diversity metrics take account evolutionary relatedness observed genera, generally giving higher diversity values samples distantly related genera. Faith (alpha diversity) UniFrac (beta diversity) examples phylogenetic metrics. ex_tree object included ecodive provides phylogenetic tree genera ex_counts. datasets, can use ecodive’s read_tree() function import phylogenetic tree newick formatted string file.","code":"## Alpha Diversity -------------------  faith(counts, tree = ex_tree) #> Saliva   Gums   Nose  Stool  #>    180    155    101    202    ## Beta Diversity --------------------  normalized_unifrac(counts, tree = ex_tree) #>          Saliva      Gums      Nose #> Gums  0.4328662                     #> Nose  0.7928701 0.6767840           #> Stool 0.9677535 0.9829736 0.9936121"},{"path":"https://cmmr.github.io/ecodive/articles/ecodive.html","id":"distance-matrices","dir":"Articles","previous_headings":"Example","what":"Distance Matrices","title":"Introduction to ecodive","text":"Beta diversity functions return dist object. can convert standard R matrix .matrix() function.","code":"dm <- bray(counts) dm #>          Saliva      Gums      Nose #> Gums  0.1428571                     #> Nose  0.5000000 0.7142857           #> Stool 0.3333333 0.2500000 0.3333333  mtx <- as.matrix(dm) mtx #>           Saliva      Gums      Nose     Stool #> Saliva 0.0000000 0.1428571 0.5000000 0.3333333 #> Gums   0.1428571 0.0000000 0.7142857 0.2500000 #> Nose   0.5000000 0.7142857 0.0000000 0.3333333 #> Stool  0.3333333 0.2500000 0.3333333 0.0000000  mtx['Saliva', 'Nose'] #> [1] 0.5"},{"path":"https://cmmr.github.io/ecodive/articles/ecodive.html","id":"performance-with-large-datasets","dir":"Articles","previous_headings":"","what":"Performance with Large Datasets","title":"Introduction to ecodive","text":"ecodive designed fast ---box. However, working large datasets (e.g., thousands samples), can gain additional performance following recommendations performance guide. reading: vignette('performance')","code":""},{"path":"https://cmmr.github.io/ecodive/articles/performance.html","id":"optimizing-ecodive-for-large-datasets","dir":"Articles","previous_headings":"","what":"Optimizing ecodive for Large Datasets","title":"Performance Guide","text":"ecodive engineered high performance, using parallelized C code deliver results quickly minimal memory usage. use cases, can pass data standard R format (like matrix data.frame) get fast results. However, working large datasets—thousands samples hundreds thousands features—can achieve noticeably better performance paying attention format input data. optimizations minimize internal data conversion steps ecodive perform.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/performance.html","id":"the-optimal-input-compressed-sparse-matrices","dir":"Articles","previous_headings":"Optimizing ecodive for Large Datasets","what":"The Optimal Input: Compressed Sparse Matrices","title":"Performance Guide","text":"ecodive highly efficient reformatting data internally one-calculations. need manually format data single function calls. However, plan run multiple ecodive functions large dataset, see performance benefit converting data optimal format first. format column-compressed sparse matrix (dgCMatrix) Matrix package, samples arranged columns. conversion , prevent ecodive reformat data subsequent function call.","code":"library(ecodive) library(Matrix)  # Assume 'my_counts' is a standard matrix with samples in rows my_counts <- as.matrix(ex_counts)  # Convert once to the optimal format optimal_counts <- as(t(my_counts), \"dgCMatrix\")  # Now, run multiple analyses on the pre-formatted object. # Remember to specify margin = 2L since samples are in columns. shannon_vals <- shannon(optimal_counts, margin = 2L) simpson_vals <- simpson(optimal_counts, margin = 2L) observed_vals <- observed(optimal_counts, margin = 2L)"},{"path":"https://cmmr.github.io/ecodive/articles/performance.html","id":"why-sparse-matrices","dir":"Articles","previous_headings":"Optimizing ecodive for Large Datasets > The Optimal Input: Compressed Sparse Matrices","what":"Why Sparse Matrices?","title":"Performance Guide","text":"Ecological datasets, particularly amplicon sequencing (16S, ) shotgun metagenomics, typically “sparse.” means given sample, vast majority species full dataset count zero. standard R matrix stores every single value, including zeros. large dataset, can consume massive amount memory. sparse matrix, hand, stores non-zero values locations. dramatically reduces memory footprint. providing dgCMatrix samples columns, feeding ecodive data preferred native format, allowing skip internal conversion proceed directly calculations.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/performance.html","id":"rbiom-users","dir":"Articles","previous_headings":"Optimizing ecodive for Large Datasets > The Optimal Input: Compressed Sparse Matrices","what":"rbiom Users","title":"Performance Guide","text":"use rbiom package manage data, ’re already taking advantage ! rbiom objects store count tables internally dgCMatrix samples columns. pass rbiom object ecodive function, passed optimal format automatically.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/performance.html","id":"handling-data-transformations","dir":"Articles","previous_headings":"Optimizing ecodive for Large Datasets","what":"Handling Data Transformations","title":"Performance Guide","text":"Many diversity metrics operate transformed data, commonly relative abundances (norm = 'percent'). specify transformation like norm = 'percent', ecodive performs conversion internally. adds small amount computational overhead. plan run many different analyses transformed data, efficient perform transformation pass pre-transformed data ecodive, specifying norm = 'none'.","code":"# Inefficient: Transforming the data twice shannon_vals <- shannon(optimal_counts, norm = 'percent', margin = 2L) simpson_vals <- simpson(optimal_counts, norm = 'percent', margin = 2L)  # More Efficient: Transform once rel_abund <- t(apply(t(optimal_counts), 1, function(x) x / sum(x))) rel_abund <- as(rel_abund, \"dgCMatrix\")  shannon_vals <- shannon(rel_abund, norm = 'none', margin = 2L) simpson_vals <- simpson(rel_abund, norm = 'none', margin = 2L)"},{"path":"https://cmmr.github.io/ecodive/articles/performance.html","id":"the-exception-centered-log-ratio-clr","dir":"Articles","previous_headings":"Optimizing ecodive for Large Datasets > Handling Data Transformations","what":"The Exception: Centered Log-Ratio (CLR)","title":"Performance Guide","text":"one exception rule centered log-ratio transformation (norm = 'clr'), used calculating Aitchison distance. standard CLR transformation turns sparse matrix “dense” matrix (zeros become non-zero values), dramatically increases memory consumption. ecodive’s internal CLR implementation uses special techniques calculate result preserving sparse matrix structure much possible. Therefore, CLR-based metrics, achieve better performance lower memory usage letting ecodive handle transformation. : :","code":"# Best for CLR: Let ecodive handle the transformation aitchison_dist <- aitchison(optimal_counts, margin = 2L) # Inefficient for CLR: Pre-transforming creates a dense matrix library(compositions) dense_matrix <- clr(t(as.matrix(optimal_counts)) + 1) # Becomes dense aitchison_dist <- euclidean(dense_matrix, norm = 'none')"},{"path":"https://cmmr.github.io/ecodive/articles/performance.html","id":"summary","dir":"Articles","previous_headings":"Optimizing ecodive for Large Datasets","what":"Summary","title":"Performance Guide","text":"best performance large datasets: Store count data dgCMatrix samples columns. Use margin = 2L ecodive function calls. repeated calculations, pre-transform data (e.g., relative abundance) use norm = 'none'. Exception: Always let ecodive handle CLR transformations using norm='clr'.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/unifrac.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"UniFrac Calculations","text":"different UniFrac algorithms listed , along examples calculating .","code":""},{"path":"https://cmmr.github.io/ecodive/articles/unifrac.html","id":"input-data","dir":"Articles","previous_headings":"","what":"Input Data","title":"UniFrac Calculations","text":"numeric matrix two samples five species. phylogenetic tree five species.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/unifrac.html","id":"definitions","dir":"Articles","previous_headings":"","what":"Definitions","title":"UniFrac Calculations","text":"branch indices (green circles) used ordering L, , B arrays. Values L drawn input phylogenetic tree. Values B total number species observations descending branch; Sample_A, B Sample_B.","code":""},{"path":"https://cmmr.github.io/ecodive/articles/unifrac.html","id":"unweighted","dir":"Articles","previous_headings":"","what":"Unweighted","title":"UniFrac Calculations","text":"Lozupone et al, 2005: Unweighted UniFrac R Package ecodive: unweighted_unifrac() R Package abdiv: unweighted_unifrac() R Package phyloseq: UniFrac(weighted=FALSE) qiime2 qiime diversity beta-phylogenetic --p-metric unweighted_unifrac mothur: unifrac.unweighted() First, transform B presence (1) absence (0) indicators. \\begin{align*}  &= \\{9, 0, 0, 0, 9, 6, 3, 3\\} \\\\ ' &= \\{1, 0, 0, 0, 1, 1, 1, 1\\} \\end{align*} \\begin{align*} B  &= \\{7, 5, 1, 4, 2, 8, 8, 0\\} \\\\ B' &= \\{1, 1, 1, 1, 1, 1, 1, 0\\} \\end{align*} apply formula: \\begin{align*} U &= \\displaystyle \\frac{\\sum_{= 1}^{n} L_i(|'_i - B'_i|)}{\\sum_{= 1}^{n} L_i(max('_i,B'_i))}  \\\\ \\\\ U &= \\displaystyle \\frac{L_1(|'_1-B'_1|) + L_2(|'_2-B'_2|) + \\cdots + L_n(|'_n-B'_n|)}{L_1(max('_1,B'_1)) + L_2(max('_2,B'_2)) + \\cdots + L_n(max('_n,B'_n))}  \\\\ \\\\ U &= \\displaystyle \\frac{0.2(|1-1|) + 0.4(|0-1|) + \\cdots + 0.3(|1-0|)}{0.2(max(1,1)) + 0.4(max(0,1)) + \\cdots + 0.3(max(1,0))}  \\\\ \\\\ U &= \\displaystyle \\frac{0.2(0) + 0.4(1) + 0.8(1) + 0.5(1) + 0.9(0) + 0.6(0) + 0.7(0) + 0.3(1)}{0.2(1) + 0.4(1) + 0.8(1) + 0.5(1) + 0.9(1) + 0.6(1) + 0.7(1) + 0.3(1)}  \\\\ \\\\ U &= \\displaystyle \\frac{0.4 + 0.8 + 0.5 + 0.3}{0.2 + 0.4 + 0.8 + 0.5 + 0.9 + 0.6 + 0.7 + 0.3}  \\\\ \\\\ U &= \\displaystyle \\frac{2}{4.4}  \\\\ \\\\ U &= 0.4545455 \\end{align*}","code":""},{"path":"https://cmmr.github.io/ecodive/articles/unifrac.html","id":"weighted","dir":"Articles","previous_headings":"","what":"Weighted","title":"UniFrac Calculations","text":"Lozupone et al, 2007: Raw Weighted UniFrac R Package ecodive: weighted_unifrac() R Package abdiv: weighted_unifrac() R Package phyloseq: UniFrac(weighted=TRUE, normalized=FALSE) qiime2 qiime diversity beta-phylogenetic --p-metric weighted_unifrac \\begin{align*} W &= \\sum_{= 1}^{n} L_i|\\frac{A_i}{A_T} - \\frac{B_i}{B_T}|  \\\\ \\\\ W &= L_1|\\frac{A_1}{A_T} - \\frac{B_1}{B_T}| + L_2|\\frac{A_2}{A_T} - \\frac{B_2}{B_T}| + \\cdots + L_n|\\frac{A_n}{A_T} - \\frac{B_n}{B_T}|  \\\\ \\\\ W &= 0.2|\\frac{9}{15} - \\frac{7}{15}| + 0.4|\\frac{0}{15} - \\frac{5}{15}| + \\cdots + 0.3|\\frac{3}{15} - \\frac{0}{15}|  \\\\ \\\\ W &= 0.02\\overline{6} + 0.1\\overline{3} + 0.05\\overline{3} + 0.1\\overline{3} + 0.42 + 0.08 + 0.2\\overline{3} + 0.06  \\\\ \\\\ W &= 1.14 \\end{align*}","code":""},{"path":"https://cmmr.github.io/ecodive/articles/unifrac.html","id":"normalized","dir":"Articles","previous_headings":"","what":"Normalized","title":"UniFrac Calculations","text":"Lozupone et al, 2007: Normalized Weighted UniFrac R Package ecodive: normalized_unifrac() R Package abdiv: weighted_normalized_unifrac() R Package phyloseq: UniFrac(weighted=TRUE, normalized=TRUE) qiime2 qiime diversity beta-phylogenetic --p-metric weighted_normalized_unifrac mothur: unifrac.weighted() \\begin{align*}  N &= \\displaystyle \\frac   {\\sum_{= 1}^{n} L_i|\\frac{A_i}{A_T} - \\frac{B_i}{B_T}|}   {\\sum_{= 1}^{n} L_i(\\frac{A_i}{A_T} + \\frac{B_i}{B_T})}   \\\\ \\\\    N &= \\displaystyle \\frac   {L_1|\\frac{A_1}{A_T} - \\frac{B_1}{B_T}| + L_2|\\frac{A_2}{A_T} - \\frac{B_2}{B_T}| + \\cdots + L_n|\\frac{A_n}{A_T} - \\frac{B_n}{B_T}|}   {L_1(\\frac{A_1}{A_T} + \\frac{B_1}{B_T}) + L_2(\\frac{A_2}{A_T} + \\frac{B_2}{B_T}) + \\cdots + L_n(\\frac{A_n}{A_T} + \\frac{B_n}{B_T})}   \\\\ \\\\    N &= \\displaystyle \\frac   {0.2|\\frac{9}{15} - \\frac{7}{15}| + 0.4|\\frac{0}{15} - \\frac{5}{15}| + \\cdots + 0.3|\\frac{3}{15} - \\frac{0}{15}|}   {0.2(\\frac{9}{15} + \\frac{7}{15}) + 0.4(\\frac{0}{15} + \\frac{5}{15}) + \\cdots + 0.3(\\frac{3}{15} + \\frac{0}{15})}   \\\\ \\\\    N &= \\displaystyle \\frac   {0.02\\overline{6} + 0.1\\overline{3} + 0.05\\overline{3} + 0.1\\overline{3} + 0.42 + 0.08 + 0.2\\overline{3} + 0.06}   {0.21\\overline{3} + 0.1\\overline{3} + 0.05\\overline{3} + 0.1\\overline{3} + 0.66 + 0.56 + 0.51\\overline{3} + 0.06}   \\\\ \\\\    N &= \\displaystyle \\frac{1.14}{2.326667}  \\\\ \\\\ N &= 0.4899713 \\end{align*}","code":""},{"path":"https://cmmr.github.io/ecodive/articles/unifrac.html","id":"generalized","dir":"Articles","previous_headings":"","what":"Generalized","title":"UniFrac Calculations","text":"Chen et al. 2012: Generalized UniFrac R Package ecodive: generalized_unifrac(alpha = 0.5) R Package abdiv: generalized_unifrac(alpha = 0.5) R Package GUniFrac: GUniFrac(alpha = 0.5) qiime2 qiime diversity beta-phylogenetic --p-metric generalized_unifrac -0.5 \\begin{align*}  G &= \\displaystyle \\frac   {\\sum_{= 1}^{n} L_i(\\frac{A_i}{A_T} + \\frac{B_i}{B_T})^{\\alpha}     |\\displaystyle \\frac       {\\frac{A_i}{A_T} - \\frac{B_i}{B_T}}       {\\frac{A_i}{A_T} + \\frac{B_i}{B_T}} |}   {\\sum_{= 1}^{n} L_i(\\frac{A_i}{A_T} + \\frac{B_i}{B_T})^{\\alpha}}  \\\\ \\\\  G &= \\displaystyle \\frac   {     L_1(\\frac{A_1}{A_T} + \\frac{B_1}{B_T})^{0.5}       |\\displaystyle \\frac         {\\frac{A_1}{A_T} - \\frac{B_1}{B_T}}         {\\frac{A_1}{A_T} + \\frac{B_1}{B_T}}| +     \\cdots +     L_n(\\frac{A_n}{A_T} + \\frac{B_n}{B_T})^{0.5}       |\\displaystyle \\frac         {\\frac{A_n}{A_T} - \\frac{B_n}{B_T}}         {\\frac{A_n}{A_T} + \\frac{B_n}{B_T}}|   }{     L_1(\\frac{A_1}{A_T} + \\frac{B_1}{B_T})^{0.5} +     \\cdots +     L_n(\\frac{A_n}{A_T} + \\frac{B_n}{B_T})^{0.5}   }     \\\\ \\\\  G &= \\displaystyle \\frac   {     0.2(\\frac{9}{15} + \\frac{7}{15})^{0.5}       |\\displaystyle \\frac         {\\frac{9}{15} - \\frac{7}{15}}         {\\frac{9}{15} + \\frac{7}{15}}| +     \\cdots +     0.3(\\frac{3}{15} + \\frac{0}{15})^{0.5}       |\\displaystyle \\frac         {\\frac{3}{15} - \\frac{0}{15}}         {\\frac{3}{15} + \\frac{0}{15}}|   }{     0.2(\\frac{9}{15} + \\frac{7}{15})^{0.5} +     \\cdots +     0.3(\\frac{3}{15} + \\frac{0}{15})^{0.5}   }     \\\\ \\\\    G &\\approx \\displaystyle \\frac   {0.03 + 0.23 + 0.21 + 0.26 + 0.49 + 0.08 + 0.27 + 0.13}   {0.21 + 0.23 + 0.21 + 0.26 + 0.77 + 0.58 + 0.60 + 0.13}   \\\\ \\\\    G &= \\displaystyle \\frac{1.701419}{2.986235}  \\\\ \\\\ G &= 0.569754  \\end{align*}","code":""},{"path":"https://cmmr.github.io/ecodive/articles/unifrac.html","id":"variance-adjusted","dir":"Articles","previous_headings":"","what":"Variance Adjusted","title":"UniFrac Calculations","text":"Chang et al, 2011: Variance Adjusted Weighted (VAW) UniFrac R Package ecodive: variance_adjusted_unifrac() R Package abdiv: variance_adjusted_unifrac() qiime2 qiime diversity beta-phylogenetic --p-metric weighted_normalized_unifrac --p-variance-adjusted \\begin{align*}  V &= \\displaystyle \\frac   {\\sum_{= 1}^{n} L_i\\displaystyle \\frac     {|\\frac{A_i}{A_T} - \\frac{B_i}{B_T}|}     {\\sqrt{(A_i + B_i)(A_T + B_T - A_i - B_i)}} }   {\\sum_{= 1}^{n} L_i\\displaystyle \\frac     {\\frac{A_i}{A_T} + \\frac{B_i}{B_T}}     {\\sqrt{(A_i + B_i)(A_T + B_T - A_i - B_i)}} }  \\\\ \\\\  V &= \\displaystyle \\frac   {     L_1\\displaystyle \\frac     {|\\frac{A_1}{A_T} - \\frac{B_1}{B_T}|}     {\\sqrt{(A_1 + B_1)(A_T + B_T - A_1 - B_1)}} +     \\cdots +     L_n\\displaystyle \\frac     {|\\frac{A_n}{A_T} - \\frac{B_n}{B_T}|}     {\\sqrt{(A_n + B_n)(A_T + B_T - A_n - B_n)}}   }{     L_1\\displaystyle \\frac     {\\frac{A_1}{A_T} + \\frac{B_1}{B_T}}     {\\sqrt{(A_1 + B_1)(A_T + B_T - A_1 - B_1)}} +     \\cdots +     L_n\\displaystyle \\frac     {\\frac{A_n}{A_T} + \\frac{B_n}{B_T}}     {\\sqrt{(A_n + B_n)(A_T + B_T - A_n - B_n)}}   }     \\\\ \\\\  V &= \\displaystyle \\frac   {     0.2\\displaystyle \\frac     {|\\frac{9}{15} - \\frac{7}{15}|}     {\\sqrt{(9 + 7)(15 + 15 - 9 - 7)}} +     \\cdots +     0.3\\displaystyle \\frac     {|\\frac{3}{15} - \\frac{0}{15}|}     {\\sqrt{(3 + 0)(15 + 15 - 3 - 0)}}   }{     0.2\\displaystyle \\frac     {\\frac{9}{15} + \\frac{7}{15}}     {\\sqrt{(9 + 7)(15 + 15 - 9 - 7)}} +     \\cdots +     0.3\\displaystyle \\frac     {\\frac{3}{15} + \\frac{0}{15}}     {\\sqrt{(3 + 0)(15 + 15 - 3 - 0)}}   }     \\\\ \\\\    V &\\approx \\displaystyle \\frac   {0.002 + 0.012 + 0.010 + 0.013 + 0.029 + 0.005 + 0.016 + 0.007}   {0.014 + 0.012 + 0.010 + 0.013 + 0.046 + 0.037 + 0.036 + 0.007}   \\\\ \\\\    V &= \\displaystyle \\frac{4.09389}{4.174402}  \\\\ \\\\ V &= 0.9807128  \\end{align*}","code":""},{"path":"https://cmmr.github.io/ecodive/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Daniel P. Smith. Author, maintainer. Alkek Center Metagenomics Microbiome Research. Copyright holder, funder.","code":""},{"path":"https://cmmr.github.io/ecodive/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Smith D (2026). ecodive: Parallel Memory-Efficient Ecological Diversity Metrics. R package version 2.2.3, https://cmmr.github.io/ecodive/.","code":"@Manual{,   title = {ecodive: Parallel and Memory-Efficient Ecological Diversity Metrics},   author = {Daniel P. Smith},   year = {2026},   note = {R package version 2.2.3},   url = {https://cmmr.github.io/ecodive/}, }"},{"path":"https://cmmr.github.io/ecodive/index.html","id":"ecodive-","dir":"","previous_headings":"","what":"Parallel and Memory-Efficient Ecological Diversity Metrics","title":"Parallel and Memory-Efficient Ecological Diversity Metrics","text":"ecodive R package calculating ecological diversity metrics parallelized memory-efficient manner. designed handle large datasets, common microbiome research.","code":""},{"path":"https://cmmr.github.io/ecodive/index.html","id":"why-ecodive","dir":"","previous_headings":"","what":"Why ecodive?","title":"Parallel and Memory-Efficient Ecological Diversity Metrics","text":"Analyzing ecological diversity often computational bottleneck, especially large datasets. ecodive addresses providing: High Performance: ecodive written C parallelized using pthreads, making dramatically faster R packages. Benchmarks show can 9,000x faster use 200,000x less memory. Zero Dependencies: package external R dependencies, making lightweight, stable, easy install. also makes ideal secure backend R packages. Comprehensive Metrics: implements wide range common alpha beta diversity metrics, including classic phylogenetic-aware methods like Faith’s PD complete UniFrac family. Ease Use: API simple integrates seamlessly popular bioinformatics packages like phyloseq rbiom.","code":""},{"path":"https://cmmr.github.io/ecodive/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Parallel and Memory-Efficient Ecological Diversity Metrics","text":"latest stable version can installed CRAN. development version available GitHub.","code":"install.packages('ecodive') install.packages('pak') pak::pak('cmmr/ecodive')"},{"path":"https://cmmr.github.io/ecodive/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Parallel and Memory-Efficient Ecological Diversity Metrics","text":"ecodive functions straightforward use. examples.","code":""},{"path":"https://cmmr.github.io/ecodive/index.html","id":"with-phyloseq-or-rbiom-objects","dir":"","previous_headings":"Usage","what":"With phyloseq or rbiom objects","title":"Parallel and Memory-Efficient Ecological Diversity Metrics","text":"easiest way use ecodive phyloseq, rbiom, TreeSummarizedExperiment object. objects conveniently bundle count data phylogenetic tree.","code":"library(ecodive) data(esophagus, package = 'phyloseq') data(hmp50,     package = 'rbiom')  # Calculate weighted UniFrac distance w_unifrac <- weighted_unifrac(esophagus) print(w_unifrac) #>           B         C #> C 0.1050480           #> D 0.1401124 0.1422409  # Calculate Faith's Phylogenetic Diversity faith_pd <- faith(hmp50) print(faith_pd[1:4]) #>   HMP01   HMP02   HMP03   HMP04  #> 6.22296 8.59432 8.93375 9.86597"},{"path":"https://cmmr.github.io/ecodive/index.html","id":"with-basic-r-objects","dir":"","previous_headings":"Usage","what":"With basic R objects","title":"Parallel and Memory-Efficient Ecological Diversity Metrics","text":"can also provide count data phylogenetic tree separate objects. ex_counts ex_tree objects included ecodive.","code":"## Example Data ---------------------- counts <- rarefy(ex_counts) counts[,1:4] #>        Streptococcus Bacteroides Corynebacterium Haemophilus #> Saliva           162           2               0         180 #> Gums             309           2               0          34 #> Nose               6           0             171           0 #> Stool              1         341               1           1   ## Alpha Diversity ------------------- shannon(counts) #>     Saliva       Gums       Nose      Stool  #> 0.74119910 0.35692121 1.10615349 0.07927797   faith(counts, tree = ex_tree) #> Saliva   Gums   Nose  Stool  #>    180    155    101    202    ## Beta Diversity -------------------- bray(counts) #>          Saliva      Gums      Nose #> Gums  0.4260870                     #> Nose  0.9797101 0.9826087           #> Stool 0.9884058 0.9884058 0.9913043  weighted_unifrac(counts, tree = ex_tree) #>          Saliva      Gums      Nose #> Gums   36.97681                     #> Nose   67.23768  55.97101           #> Stool 109.77971 109.44058 110.00870"},{"path":"https://cmmr.github.io/ecodive/index.html","id":"available-methods","dir":"","previous_headings":"","what":"Available Methods","title":"Parallel and Memory-Efficient Ecological Diversity Metrics","text":"Use list_metrics() browse metrics available calculating diversity.","code":"# Alpha Diversity list_metrics('alpha', 'id') #>  [1] \"ace\"         \"berger\"      \"brillouin\"   \"chao1\"       \"faith\"       #>  [6] \"fisher\"      \"simpson\"     \"inv_simpson\" \"margalef\"    \"mcintosh\"    #> [11] \"menhinick\"   \"observed\"    \"shannon\"     \"squares\"      # Beta Diversity list_metrics('beta', 'id') #>  [1] \"aitchison\"                 \"bhattacharyya\"             \"bray\"                      #>  [4] \"canberra\"                  \"chebyshev\"                 \"chord\"                     #>  [7] \"clark\"                     \"sorensen\"                  \"divergence\"                #> [10] \"euclidean\"                 \"generalized_unifrac\"       \"gower\"                     #> [13] \"hamming\"                   \"hellinger\"                 \"horn\"                      #> [16] \"jaccard\"                   \"jensen\"                    \"jsd\"                       #> [19] \"lorentzian\"                \"manhattan\"                 \"matusita\"                  #> [22] \"minkowski\"                 \"morisita\"                  \"motyka\"                    #> [25] \"normalized_unifrac\"        \"ochiai\"                    \"psym_chisq\"                #> [28] \"soergel\"                   \"squared_chisq\"             \"squared_chord\"             #> [31] \"squared_euclidean\"         \"topsoe\"                    \"unweighted_unifrac\"        #> [34] \"variance_adjusted_unifrac\" \"wave_hedges\"               \"weighted_unifrac\""},{"path":"https://cmmr.github.io/ecodive/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Parallel and Memory-Efficient Ecological Diversity Metrics","text":"online manual ecodive available https://cmmr.github.io/ecodive/. includes getting started guide, articles alpha/beta diversity, reference pages function.","code":""},{"path":"https://cmmr.github.io/ecodive/index.html","id":"testing","dir":"","previous_headings":"","what":"Testing","title":"Parallel and Memory-Efficient Ecological Diversity Metrics","text":"ecodive comprehensive test suite using testthat package. code automatically tested via GitHub Actions upon push repository ensure functionality stability. users cloned source repository, tests can run locally following commands R session:","code":"install.packages('testthat') devtools::test()"},{"path":[]},{"path":"https://cmmr.github.io/ecodive/index.html","id":"support","dir":"","previous_headings":"Community guidelines","what":"Support","title":"Parallel and Memory-Efficient Ecological Diversity Metrics","text":"Bug reports, feature requests, general questions can submitted https://github.com/cmmr/ecodive/issues.","code":""},{"path":"https://cmmr.github.io/ecodive/index.html","id":"contributing","dir":"","previous_headings":"Community guidelines","what":"Contributing","title":"Parallel and Memory-Efficient Ecological Diversity Metrics","text":"Pull requests welcome. Please ensure contributed code covered tests documentation (add additional tests documentation needed) passes automated tests. New functions must leverage C pthreads minimize memory CPU time. Please note ecodive project released Contributor Code Conduct. contributing project, agree abide terms.","code":""},{"path":"https://cmmr.github.io/ecodive/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Parallel and Memory-Efficient Ecological Diversity Metrics","text":"MIT License © 2026 ecodive authors","code":""},{"path":"https://cmmr.github.io/ecodive/reference/ace.html","id":null,"dir":"Reference","previous_headings":"","what":"Abundance-based Coverage Estimator (ACE) — ace","title":"Abundance-based Coverage Estimator (ACE) — ace","text":"non-parametric estimator species richness separates features abundant rare groups.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/ace.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Abundance-based Coverage Estimator (ACE) — ace","text":"","code":"ace(counts, cutoff = 10L, margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/ace.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Abundance-based Coverage Estimator (ACE) — ace","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. cutoff maximum number observations consider \"rare\". Default: 10. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/ace.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Abundance-based Coverage Estimator (ACE) — ace","text":"ACE metric separates features \"abundant\" \"rare\" groups based cutoff (usually 10 counts). assumes presence abundant species certain, true number rare species must estimated. Equations: $$C_{ace} = 1 - \\frac{F_1}{X_{rare}}$$ $$\\gamma_{ace}^2 = \\max\\left[\\frac{F_{rare} \\sum_{=1}^{r}(-1)F_i}{C_{ace}X_{rare}(X_{rare} - 1)} - 1, 0\\right]$$ $$D_{ace} = F_{abund} + \\frac{F_{rare}}{C_{ace}} + \\frac{F_1}{C_{ace}}\\gamma_{ace}^2$$ : \\(r\\) : Rare cutoff (default 10). Features \\(\\le r\\) counts considered rare. \\(F_i\\) : Number features exactly \\(\\) counts. \\(F_1\\) : Number features \\(X_i = 1\\) (singletons). \\(F_{rare}\\) : Number rare features \\(X_i \\le r\\). \\(F_{abund}\\) : Number abundant features \\(X_i > r\\). \\(X_{rare}\\) : Total counts belonging rare features. \\(C_{ace}\\) : sample abundance coverage estimator. \\(\\gamma_{ace}^2\\) : estimated coefficient variation. Parameter: cutoff integer threshold distinguishing rare abundant species. Standard practice use 10.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/ace.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Abundance-based Coverage Estimator (ACE) — ace","text":"Chao, ., & Lee, S. M. (1992). Estimating number classes via sample coverage. Journal American Statistical Association, 87(417), 210-217. doi:10.1080/01621459.1992.10475194","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/ace.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Abundance-based Coverage Estimator (ACE) — ace","text":"","code":"ace(ex_counts) #> Saliva   Gums   Nose  Stool  #>    5.0    8.9    6.0    NaN"},{"path":"https://cmmr.github.io/ecodive/reference/aitchison.html","id":null,"dir":"Reference","previous_headings":"","what":"Aitchison distance — aitchison","title":"Aitchison distance — aitchison","text":"Calculates Euclidean distance centered log-ratio (CLR) transformed abundances.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/aitchison.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aitchison distance — aitchison","text":"","code":"aitchison(   counts,   pseudocount = NULL,   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/aitchison.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aitchison distance — aitchison","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. pseudocount value add counts counts prevent taking log(0) unobserved features. default, NULL, selects smallest non-zero value counts. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/aitchison.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Aitchison distance — aitchison","text":"Aitchison distance defined : $$\\sqrt{\\sum_{=1}^{n} [(\\ln{X_i} - X_L) - (\\ln{Y_i} - Y_L)]^2}$$ : \\(X_i\\), \\(Y_i\\) : Absolute counts \\(\\)-th feature. \\(X_L\\), \\(Y_L\\) : Mean log abundances. \\(X_L = \\frac{1}{n}\\sum_{=1}^{n} \\ln{X_i}\\). \\(n\\) : number features. Parameter: pseudocount formula uses logarithms, zeros data must handled. pseudocount argument adds small value counts prior calculation. Base R Equivalent:","code":"x <- log((x + pseudocount) / exp(mean(log(x + pseudocount)))) y <- log((y + pseudocount) / exp(mean(log(y + pseudocount)))) sqrt(sum((x-y)^2)) # Euclidean distance"},{"path":"https://cmmr.github.io/ecodive/reference/aitchison.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Aitchison distance — aitchison","text":"Aitchison, J. (1986). statistical analysis compositional data. Chapman Hall. doi:10.1007/978-94-009-4109-3 Aitchison, J. (1982). statistical analysis compositional data. Journal Royal Statistical Society: Series B (Methodological), 44(2), 139-160. doi:10.1111/j.2517-6161.1982.tb01195.x","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/aitchison.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Aitchison distance — aitchison","text":"","code":"aitchison(ex_counts, pseudocount = 1) #>         Saliva     Gums     Nose #> Gums  1.748405                   #> Nose  9.710741 9.862353          #> Stool 8.245648 8.372391 9.409111"},{"path":"https://cmmr.github.io/ecodive/reference/alpha_div.html","id":null,"dir":"Reference","previous_headings":"","what":"Alpha Diversity Wrapper Function — alpha_div","title":"Alpha Diversity Wrapper Function — alpha_div","text":"Alpha Diversity Wrapper Function","code":""},{"path":"https://cmmr.github.io/ecodive/reference/alpha_div.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Alpha Diversity Wrapper Function — alpha_div","text":"","code":"alpha_div(   counts,   metric,   norm = \"percent\",   cutoff = 10L,   digits = 3L,   tree = NULL,   margin = 1L,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/alpha_div.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Alpha Diversity Wrapper Function — alpha_div","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. metric name alpha diversity metric. One c('ace', 'berger', 'brillouin', 'chao1', 'faith', 'fisher', 'inv_simpson', 'margalef', 'mcintosh', 'menhinick', 'observed', 'shannon', 'simpson', 'squares'). Case-insensitive partial name matching supported. Programmatic access via list_metrics('alpha'). norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. cutoff maximum number observations consider \"rare\". Default: 10. digits Precision returned values, number decimal places. E.g. default digits=3 return 6.392. tree phylo-class object representing phylogenetic tree OTUs counts. OTU identifiers given colnames(counts) must present tree. Can omitted tree embedded counts object attr(counts, 'tree'). margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/alpha_div.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Alpha Diversity Wrapper Function — alpha_div","text":"numeric vector.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/alpha_div.html","id":"integer-count-requirements","dir":"Reference","previous_headings":"","what":"Integer Count Requirements","title":"Alpha Diversity Wrapper Function — alpha_div","text":"frequent critical error alpha diversity analysis providing wrong type data metric's formula. indices mathematically defined based counts individuals require raw, integer abundance data. Others based proportional abundances can accept either integer counts (converted proportions) pre-normalized proportional data. Using proportional data metric requires integer counts return error message.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/alpha_div.html","id":"requires-integer-counts-only","dir":"Reference","previous_headings":"","what":"Requires Integer Counts Only","title":"Alpha Diversity Wrapper Function — alpha_div","text":"Chao1 ACE Squares Richness Estimator Margalef's Index Menhinick's Index Fisher's Alpha Brillouin Index","code":""},{"path":"https://cmmr.github.io/ecodive/reference/alpha_div.html","id":"can-use-proportional-data","dir":"Reference","previous_headings":"","what":"Can Use Proportional Data","title":"Alpha Diversity Wrapper Function — alpha_div","text":"Observed Features Shannon Index Gini-Simpson Index Inverse Simpson Index Berger-Parker Index McIntosh Index Faith's PD","code":""},{"path":"https://cmmr.github.io/ecodive/reference/alpha_div.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Alpha Diversity Wrapper Function — alpha_div","text":"","code":"# Example counts matrix     ex_counts #>        Streptococcus Bacteroides Corynebacterium Haemophilus Propionibacterium #> Saliva           162           2               0         180                 1 #> Gums             793           4               0          87                 1 #> Nose              22           2             498           2               251 #> Stool              1         611               1           1                 0 #>        Staphylococcus #> Saliva              0 #> Gums                1 #> Nose              236 #> Stool               1          # Shannon diversity values     alpha_div(ex_counts, 'Shannon') #>     Saliva       Gums       Nose      Stool  #> 0.74119910 0.36684449 1.14222899 0.04824952           # Chao1 diversity values     alpha_div(ex_counts, 'c') #> Saliva   Gums   Nose  Stool  #>    4.5    Inf    6.0    Inf           # Faith PD values     alpha_div(ex_counts, 'faith', tree = ex_tree) #> Saliva   Gums   Nose  Stool  #>    180    191    215    202"},{"path":"https://cmmr.github.io/ecodive/reference/berger.html","id":null,"dir":"Reference","previous_headings":"","what":"Berger-Parker Index — berger","title":"Berger-Parker Index — berger","text":"measure numerical importance abundant species.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/berger.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Berger-Parker Index — berger","text":"","code":"berger(counts, norm = \"percent\", margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/berger.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Berger-Parker Index — berger","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/berger.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Berger-Parker Index — berger","text":"Berger-Parker index defined proportional abundance dominant feature: $$\\max(P_i)$$ : \\(P_i\\) : Proportional abundance \\(\\)-th feature. Base R Equivalent:","code":"max(x / sum(x))"},{"path":"https://cmmr.github.io/ecodive/reference/berger.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Berger-Parker Index — berger","text":"Berger, W. H., & Parker, F. L. (1970). Diversity planktonic foraminifera deep-sea sediments. Science, 168(3937), 1345-1347. doi:10.1126/science.168.3937.1345","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/berger.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Berger-Parker Index — berger","text":"","code":"berger(ex_counts) #>    Saliva      Gums      Nose     Stool  #> 0.5217391 0.8950339 0.4925816 0.9934959"},{"path":"https://cmmr.github.io/ecodive/reference/beta_div.html","id":null,"dir":"Reference","previous_headings":"","what":"Beta Diversity Wrapper Function — beta_div","title":"Beta Diversity Wrapper Function — beta_div","text":"Beta Diversity Wrapper Function","code":""},{"path":"https://cmmr.github.io/ecodive/reference/beta_div.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Beta Diversity Wrapper Function — beta_div","text":"","code":"beta_div(   counts,   metric,   norm = \"percent\",   power = 1.5,   pseudocount = NULL,   alpha = 0.5,   tree = NULL,   pairs = NULL,   margin = 1L,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/beta_div.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Beta Diversity Wrapper Function — beta_div","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. metric name beta diversity metric. One c('aitchison', 'bhattacharyya', 'bray', 'canberra', 'chebyshev', 'chord', 'clark', 'divergence', 'euclidean', 'generalized_unifrac', 'gower', 'hamming', 'hellinger', 'horn', 'jaccard', 'jensen', 'jsd', 'lorentzian', 'manhattan', 'matusita', 'minkowski', 'morisita', 'motyka', 'normalized_unifrac', 'ochiai', 'psym_chisq', 'soergel', 'sorensen', 'squared_chisq', 'squared_chord', 'squared_euclidean', 'topsoe', 'unweighted_unifrac', 'variance_adjusted_unifrac', 'wave_hedges', 'weighted_unifrac'). Flexible matching supported (see ). Programmatic access via list_metrics('beta'). norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. power Scaling factor magnitude differences communities (\\(p\\)). Default: 1.5 pseudocount value add counts counts prevent taking log(0) unobserved features. default, NULL, selects smallest non-zero value counts. alpha much weight give relative abundances; value 0 1, inclusive. Setting alpha=1 equivalent normalized_unifrac(). tree phylo-class object representing phylogenetic tree OTUs counts. OTU identifiers given colnames(counts) must present tree. Can omitted tree embedded counts object attr(counts, 'tree'). pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/beta_div.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Beta Diversity Wrapper Function — beta_div","text":"numeric vector.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/beta_div.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Beta Diversity Wrapper Function — beta_div","text":"List Beta Diversity Metrics Flexible name matching Case insensitive partial matching. runs non-alpha characters converted underscores. E.g. metric = 'Weighted UniFrac selects weighted_unifrac. UniFrac names can shortened first letter plus \"unifrac\". E.g. uunifrac, w_unifrac, V UniFrac. also support partial matching. Finished code always use full primary option name avoid ambiguity future additions metrics list.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/beta_div.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Beta Diversity Wrapper Function — beta_div","text":"","code":"# Example counts matrix     ex_counts #>        Streptococcus Bacteroides Corynebacterium Haemophilus Propionibacterium #> Saliva           162           2               0         180                 1 #> Gums             793           4               0          87                 1 #> Nose              22           2             498           2               251 #> Stool              1         611               1           1                 0 #>        Staphylococcus #> Saliva              0 #> Gums                1 #> Nose              236 #> Stool               1          # Bray-Curtis distances     beta_div(ex_counts, 'bray') #>          Saliva      Gums      Nose #> Gums  0.4265973                     #> Nose  0.9713843 0.9720256           #> Stool 0.9909509 0.9911046 0.9915177          # Generalized UniFrac distances     beta_div(ex_counts, 'GUniFrac', tree = ex_tree) #>          Saliva      Gums      Nose #> Gums  0.4471644                     #> Nose  0.8215129 0.7607876           #> Stool 0.9727827 0.9784242 0.9730332"},{"path":"https://cmmr.github.io/ecodive/reference/bhattacharyya.html","id":null,"dir":"Reference","previous_headings":"","what":"Bhattacharyya distance — bhattacharyya","title":"Bhattacharyya distance — bhattacharyya","text":"Measures similarity two probability distributions.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/bhattacharyya.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bhattacharyya distance — bhattacharyya","text":"","code":"bhattacharyya(   counts,   norm = \"percent\",   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/bhattacharyya.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bhattacharyya distance — bhattacharyya","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/bhattacharyya.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bhattacharyya distance — bhattacharyya","text":"Bhattacharyya distance defined : $$-\\ln{\\sum_{=1}^{n}\\sqrt{P_{}Q_{}}}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"-log(sum(sqrt(x * y)))"},{"path":"https://cmmr.github.io/ecodive/reference/bhattacharyya.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bhattacharyya distance — bhattacharyya","text":"Bhattacharyya, . (1943). measure divergence two statistical populations defined probability distributions. Bulletin Calcutta Mathematical Society, 35, 99-109.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/bhattacharyya.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bhattacharyya distance — bhattacharyya","text":"","code":"bhattacharyya(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.1260663                     #> Nose  1.8114121 1.6636016           #> Stool 2.0200478 2.1276915 2.3040081"},{"path":"https://cmmr.github.io/ecodive/reference/bray.html","id":null,"dir":"Reference","previous_headings":"","what":"Bray-Curtis dissimilarity — bray","title":"Bray-Curtis dissimilarity — bray","text":"standard ecological metric quantifying dissimilarity communities.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/bray.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bray-Curtis dissimilarity — bray","text":"","code":"bray(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/bray.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bray-Curtis dissimilarity — bray","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/bray.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bray-Curtis dissimilarity — bray","text":"Bray-Curtis dissimilarity defined : $$\\frac{\\sum_{=1}^{n} |P_i - Q_i|}{\\sum_{=1}^{n} (P_i + Q_i)}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sum(abs(x-y)) / sum(x+y)"},{"path":"https://cmmr.github.io/ecodive/reference/bray.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bray-Curtis dissimilarity — bray","text":"Bray, J. R., & Curtis, J. T. (1957). ordination upland forest communities southern Wisconsin. Ecological Monographs, 27(4), 325-349. doi:10.2307/1942268","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/bray.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bray-Curtis dissimilarity — bray","text":"","code":"bray(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.4265973                     #> Nose  0.9713843 0.9720256           #> Stool 0.9909509 0.9911046 0.9915177"},{"path":"https://cmmr.github.io/ecodive/reference/brillouin.html","id":null,"dir":"Reference","previous_headings":"","what":"Brillouin Index — brillouin","title":"Brillouin Index — brillouin","text":"diversity index derived information theory, appropriate fully censused communities.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/brillouin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Brillouin Index — brillouin","text":"","code":"brillouin(counts, margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/brillouin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Brillouin Index — brillouin","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/brillouin.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Brillouin Index — brillouin","text":"Brillouin index defined : $$\\frac{\\ln{[(\\sum_{= 1}^{n} X_i)!]} - \\sum_{= 1}^{n} \\ln{(X_i!)}}{\\sum_{= 1}^{n} X_i}$$ : \\(n\\) : number features. \\(X_i\\) : Integer count \\(\\)-th feature. Base R Equivalent:","code":"# note: lgamma(x + 1) == log(x!) (lgamma(sum(x) + 1) - sum(lgamma(x + 1))) / sum(x)"},{"path":"https://cmmr.github.io/ecodive/reference/brillouin.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Brillouin Index — brillouin","text":"Brillouin, L. (1956). Science information theory. Academic Press.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/brillouin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Brillouin Index — brillouin","text":"","code":"brillouin(ex_counts) #>     Saliva       Gums       Nose      Stool  #> 0.72541640 0.35924823 1.13029903 0.04175076"},{"path":"https://cmmr.github.io/ecodive/reference/canberra.html","id":null,"dir":"Reference","previous_headings":"","what":"Canberra distance — canberra","title":"Canberra distance — canberra","text":"weighted version Manhattan distance, sensitive differences values small.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/canberra.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Canberra distance — canberra","text":"","code":"canberra(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/canberra.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Canberra distance — canberra","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/canberra.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Canberra distance — canberra","text":"Canberra distance defined : $$\\sum_{=1}^{n} \\frac{|P_i - Q_i|}{P_i + Q_i}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sum(abs(x-y) / (x+y))"},{"path":"https://cmmr.github.io/ecodive/reference/canberra.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Canberra distance — canberra","text":"Lance, G. N., & Williams, W. T. (1966). Computer programs hierarchical polythetic classification (\"similarity analyses\"). Computer Journal, 9(1), 60-64. doi:10.1093/comjnl/9.1.60","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/canberra.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Canberra distance — canberra","text":"","code":"canberra(ex_counts) #>         Saliva     Gums     Nose #> Gums  2.558846                   #> Nose  5.371936 5.285004          #> Stool 5.975282 5.135293 4.934279"},{"path":"https://cmmr.github.io/ecodive/reference/chao1.html","id":null,"dir":"Reference","previous_headings":"","what":"Chao1 Richness Estimator — chao1","title":"Chao1 Richness Estimator — chao1","text":"non-parametric estimator lower bound species richness.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/chao1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Chao1 Richness Estimator — chao1","text":"","code":"chao1(counts, margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/chao1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Chao1 Richness Estimator — chao1","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/chao1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Chao1 Richness Estimator — chao1","text":"Chao1 estimator uses ratio singletons doubletons estimate number missing species: $$n + \\frac{(F_1)^2}{2 F_2}$$ : \\(n\\) : number observed features. \\(F_1\\) : Number features observed (singletons). \\(F_2\\) : Number features observed twice (doubletons). Base R Equivalent:","code":"sum(x>0) + (sum(x == 1) ** 2) / (2 * sum(x == 2))"},{"path":"https://cmmr.github.io/ecodive/reference/chao1.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Chao1 Richness Estimator — chao1","text":"Chao, . (1984). Nonparametric estimation number classes population. Scandinavian Journal Statistics, 11, 265-270.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/chao1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Chao1 Richness Estimator — chao1","text":"","code":"chao1(ex_counts) #> Saliva   Gums   Nose  Stool  #>    4.5    Inf    6.0    Inf"},{"path":"https://cmmr.github.io/ecodive/reference/chebyshev.html","id":null,"dir":"Reference","previous_headings":"","what":"Chebyshev distance — chebyshev","title":"Chebyshev distance — chebyshev","text":"maximum difference single feature across two samples.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/chebyshev.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Chebyshev distance — chebyshev","text":"","code":"chebyshev(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/chebyshev.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Chebyshev distance — chebyshev","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/chebyshev.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Chebyshev distance — chebyshev","text":"Chebyshev distance defined : $$\\max(|P_i - Q_i|)$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. Base R Equivalent:","code":"max(abs(x-y))"},{"path":"https://cmmr.github.io/ecodive/reference/chebyshev.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Chebyshev distance — chebyshev","text":"Cantrell, C. D. (2000). Modern mathematical methods physicists engineers. Cambridge University Press.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/chebyshev.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Chebyshev distance — chebyshev","text":"","code":"chebyshev(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.4254686                     #> Nose  0.5197609 0.8732732           #> Stool 0.9876988 0.9889813 0.9915177"},{"path":"https://cmmr.github.io/ecodive/reference/chord.html","id":null,"dir":"Reference","previous_headings":"","what":"Chord distance — chord","title":"Chord distance — chord","text":"Euclidean distance normalized vectors.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/chord.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Chord distance — chord","text":"","code":"chord(counts, margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/chord.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Chord distance — chord","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/chord.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Chord distance — chord","text":"Chord distance defined : $$\\sqrt{\\sum_{=1}^{n} \\left(\\frac{X_i}{\\sqrt{\\sum_{j=1}^{n} X_j^2}} - \\frac{Y_i}{\\sqrt{\\sum_{j=1}^{n} Y_j^2}}\\right)^2}$$ : \\(X_i\\), \\(Y_i\\) : Absolute counts \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sqrt(sum(((x / sqrt(sum(x ^ 2))) - (y / sqrt(sum(y ^ 2))))^2))"},{"path":"https://cmmr.github.io/ecodive/reference/chord.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Chord distance — chord","text":"Orlóci, L. (1967). agglomerative method classification plant communities. Journal Ecology, 55(1), 193-206. doi:10.2307/2257725","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/chord.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Chord distance — chord","text":"","code":"chord(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.7126859                     #> Nose  1.3939318 1.3874634           #> Stool 1.4067198 1.4093819 1.4104270"},{"path":"https://cmmr.github.io/ecodive/reference/clark.html","id":null,"dir":"Reference","previous_headings":"","what":"Clark's divergence distance — clark","title":"Clark's divergence distance — clark","text":"Also known coefficient divergence.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/clark.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clark's divergence distance — clark","text":"","code":"clark(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/clark.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clark's divergence distance — clark","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/clark.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Clark's divergence distance — clark","text":"Clark's divergence distance defined : $$\\sqrt{\\sum_{=1}^{n}\\left(\\frac{P_i - Q_i}{P_i + Q_i}\\right)^{2}}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sqrt(sum((abs(x - y) / (x + y)) ^ 2))"},{"path":"https://cmmr.github.io/ecodive/reference/clark.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Clark's divergence distance — clark","text":"Clark, P. J. (1952). extension coefficient divergence use multiple characters. Copeia, 1952(2), 61-64. doi:10.2307/1438598","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/clark.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Clark's divergence distance — clark","text":"","code":"clark(ex_counts) #>         Saliva     Gums     Nose #> Gums  1.331390                   #> Nose  2.238579 2.223805          #> Stool 2.439423 2.223341 2.168467"},{"path":"https://cmmr.github.io/ecodive/reference/divergence.html","id":null,"dir":"Reference","previous_headings":"","what":"Divergence — divergence","title":"Divergence — divergence","text":"probabilistic divergence metric.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/divergence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Divergence — divergence","text":"","code":"divergence(   counts,   norm = \"percent\",   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/divergence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Divergence — divergence","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/divergence.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Divergence — divergence","text":"Divergence defined : $$2\\sum_{=1}^{n} \\frac{(P_i - Q_i)^2}{(P_i + Q_i)^2}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"2 * sum((x - y)^2 / (x + y)^2)"},{"path":"https://cmmr.github.io/ecodive/reference/divergence.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Divergence — divergence","text":"Cha, S.-H. (2007). Comprehensive survey distance/similarity measures probability density functions. International Journal Mathematical Models Methods Applied Sciences, 1(4), 300–307.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/divergence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Divergence — divergence","text":"","code":"divergence(ex_counts) #>          Saliva      Gums      Nose #> Gums   3.545199                     #> Nose  10.022472  9.890615           #> Stool 11.901570  9.886494  9.404494"},{"path":"https://cmmr.github.io/ecodive/reference/documentation.html","id":null,"dir":"Reference","previous_headings":"","what":"documentation — documentation","title":"documentation — documentation","text":"documentation","code":""},{"path":"https://cmmr.github.io/ecodive/reference/documentation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"documentation — documentation","text":"alpha much weight give relative abundances; value 0 1, inclusive. Setting alpha=1 equivalent normalized_unifrac(). counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores. cutoff maximum number observations consider \"rare\". Default: 10. digits Precision returned values, number decimal places. E.g. default digits=3 return 6.392. pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. power Scaling factor magnitude differences communities (\\(p\\)). Default: 1.5 pseudocount value add counts counts prevent taking log(0) unobserved features. default, NULL, selects smallest non-zero value counts. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L tree phylo-class object representing phylogenetic tree OTUs counts. OTU identifiers given colnames(counts) must present tree. Can omitted tree embedded counts object attr(counts, 'tree').","code":""},{"path":"https://cmmr.github.io/ecodive/reference/euclidean.html","id":null,"dir":"Reference","previous_headings":"","what":"Euclidean distance — euclidean","title":"Euclidean distance — euclidean","text":"straight-line distance two points multidimensional space.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/euclidean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Euclidean distance — euclidean","text":"","code":"euclidean(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/euclidean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Euclidean distance — euclidean","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/euclidean.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Euclidean distance — euclidean","text":"Euclidean distance defined : $$\\sqrt{\\sum_{=1}^{n} (P_i - Q_i)^2}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sqrt(sum((x-y)^2))"},{"path":"https://cmmr.github.io/ecodive/reference/euclidean.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Euclidean distance — euclidean","text":"Legendre, P., & Legendre, L. (2012). Numerical ecology. Elsevier.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/euclidean.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Euclidean distance — euclidean","text":"","code":"euclidean(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.6003499                     #> Nose  0.9099609 1.0628029           #> Stool 1.2103914 1.3362601 1.1575500"},{"path":"https://cmmr.github.io/ecodive/reference/ex_counts.html","id":null,"dir":"Reference","previous_headings":"","what":"Example counts matrix — ex_counts","title":"Example counts matrix — ex_counts","text":"Genera found four human body sites.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/ex_counts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example counts matrix — ex_counts","text":"","code":"ex_counts"},{"path":"https://cmmr.github.io/ecodive/reference/ex_counts.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example counts matrix — ex_counts","text":"matrix 4 samples (columns) x 6 genera (rows).","code":""},{"path":"https://cmmr.github.io/ecodive/reference/ex_counts.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example counts matrix — ex_counts","text":"Derived Human Microbiome Project dataset. https://commonfund.nih.gov/hmp","code":""},{"path":"https://cmmr.github.io/ecodive/reference/ex_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Example phylogenetic tree — ex_tree","title":"Example phylogenetic tree — ex_tree","text":"Companion tree ex_counts.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/ex_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example phylogenetic tree — ex_tree","text":"","code":"ex_tree"},{"path":"https://cmmr.github.io/ecodive/reference/ex_tree.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example phylogenetic tree — ex_tree","text":"phylo object.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/ex_tree.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Example phylogenetic tree — ex_tree","text":"ex_tree encodes tree structure:","code":"+----------44---------- Haemophilus   +-2-|   |   +----------------68---------------- Bacteroides   |   |             +---18---- Streptococcus   |      +--12--|   |      |      +--11-- Staphylococcus   +--11--|          |      +-----24----- Corynebacterium          +--12--|                 +--13-- Propionibacterium"},{"path":"https://cmmr.github.io/ecodive/reference/faith.html","id":null,"dir":"Reference","previous_headings":"","what":"Faith's Phylogenetic Diversity (PD) — faith","title":"Faith's Phylogenetic Diversity (PD) — faith","text":"Calculates sum branch lengths species present sample.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/faith.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Faith's Phylogenetic Diversity (PD) — faith","text":"","code":"faith(counts, tree = NULL, margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/faith.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Faith's Phylogenetic Diversity (PD) — faith","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. tree phylo-class object representing phylogenetic tree OTUs counts. OTU identifiers given colnames(counts) must present tree. Can omitted tree embedded counts object attr(counts, 'tree'). margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/faith.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Faith's Phylogenetic Diversity (PD) — faith","text":"Faith's PD defined : $$\\sum_{= 1}^{n} L_i A_i$$ : \\(n\\) : number branches phylogenetic tree. \\(L_i\\) : length \\(\\)-th branch. \\(A_i\\) : binary value (1 descendants branch \\(\\) present sample, 0 otherwise).","code":""},{"path":"https://cmmr.github.io/ecodive/reference/faith.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Faith's Phylogenetic Diversity (PD) — faith","text":"Faith, D. P. (1992). Conservation evaluation phylogenetic diversity. Biological Conservation, 61(1), 1-10. doi:10.1016/0006-3207(92)91201-3","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/faith.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Faith's Phylogenetic Diversity (PD) — faith","text":"","code":"faith(ex_counts, tree = ex_tree) #> Saliva   Gums   Nose  Stool  #>    180    191    215    202"},{"path":"https://cmmr.github.io/ecodive/reference/fisher.html","id":null,"dir":"Reference","previous_headings":"","what":"Fisher's Alpha — fisher","title":"Fisher's Alpha — fisher","text":"parametric diversity index assuming species abundances follow log-series distribution.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/fisher.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fisher's Alpha — fisher","text":"","code":"fisher(counts, digits = 3L, margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/fisher.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fisher's Alpha — fisher","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. digits Precision returned values, number decimal places. E.g. default digits=3 return 6.392. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/fisher.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fisher's Alpha — fisher","text":"Fisher's Alpha (\\(\\alpha\\)) parameter equation: $$\\frac{n}{\\alpha} = \\ln{\\left(1 + \\frac{X_T}{\\alpha}\\right)}$$ : \\(n\\) : number features. \\(X_T\\) : Total counts (sequencing depth). value \\(\\alpha\\) solved iteratively. Parameter: digits precision (number decimal places) use solving equation.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/fisher.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fisher's Alpha — fisher","text":"Fisher, R. ., Corbet, . S., & Williams, C. B. (1943). relation number species number individuals random sample animal population. Journal Animal Ecology, 12, 42-58. doi:10.2307/1411","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/fisher.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fisher's Alpha — fisher","text":"","code":"fisher(ex_counts) #> Saliva   Gums   Nose  Stool  #>  0.635  0.700  0.847  0.744"},{"path":"https://cmmr.github.io/ecodive/reference/generalized_unifrac.html","id":null,"dir":"Reference","previous_headings":"","what":"Generalized UniFrac (GUniFrac) — generalized_unifrac","title":"Generalized UniFrac (GUniFrac) — generalized_unifrac","text":"unified UniFrac distance balances weight abundant rare lineages.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/generalized_unifrac.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generalized UniFrac (GUniFrac) — generalized_unifrac","text":"","code":"generalized_unifrac(   counts,   tree = NULL,   alpha = 0.5,   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/generalized_unifrac.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generalized UniFrac (GUniFrac) — generalized_unifrac","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. tree phylo-class object representing phylogenetic tree OTUs counts. OTU identifiers given colnames(counts) must present tree. Can omitted tree embedded counts object attr(counts, 'tree'). alpha much weight give relative abundances; value 0 1, inclusive. Setting alpha=1 equivalent normalized_unifrac(). margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/generalized_unifrac.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generalized UniFrac (GUniFrac) — generalized_unifrac","text":"Generalized UniFrac distance defined : $$\\frac{\\sum_{=1}^{n} L_i(P_i + Q_i)^{\\alpha}\\left|\\frac{P_i - Q_i}{P_i + Q_i}\\right|}{\\sum_{=1}^{n} L_i(P_i + Q_i)^{\\alpha}}$$ : \\(n\\) : number branches tree. \\(L_i\\) : length \\(\\)-th branch. \\(P_i\\), \\(Q_i\\) : proportion community descending branch \\(\\) sample P Q. \\(\\alpha\\) : scalable weighting factor. Parameter: alpha alpha parameter controls weight given abundant lineages. \\(\\alpha = 1\\) corresponds Weighted UniFrac, \\(\\alpha = 0\\) corresponds Unweighted UniFrac.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/generalized_unifrac.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generalized UniFrac (GUniFrac) — generalized_unifrac","text":"Chen, J., Bittinger, K., Charlson, E. S., Hoffmann, C., Lewis, J., Wu, G. D., ... & Li, H. (2012). Associating microbiome composition environmental covariates using generalized UniFrac distances. Bioinformatics, 28(16), 2106-2113. doi:10.1093/bioinformatics/bts342","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/generalized_unifrac.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generalized UniFrac (GUniFrac) — generalized_unifrac","text":"","code":"generalized_unifrac(ex_counts, tree = ex_tree, alpha = 0.5) #>          Saliva      Gums      Nose #> Gums  0.4471644                     #> Nose  0.8215129 0.7607876           #> Stool 0.9727827 0.9784242 0.9730332"},{"path":"https://cmmr.github.io/ecodive/reference/gower.html","id":null,"dir":"Reference","previous_headings":"","what":"Gower distance — gower","title":"Gower distance — gower","text":"distance metric normalizes differences range feature.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/gower.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gower distance — gower","text":"","code":"gower(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/gower.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gower distance — gower","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/gower.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Gower distance — gower","text":"Gower distance defined : $$\\frac{1}{n}\\sum_{=1}^{n}\\frac{|P_i - Q_i|}{R_i}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(R_i\\) : range \\(\\)-th feature across samples (max - min). \\(n\\) : number features. Base R Equivalent: “`r r <- abs(x - y) n <- length(x) # <– sum(x|y) sum(abs(x-y) / r) / n","code":""},{"path":"https://cmmr.github.io/ecodive/reference/gower.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Gower distance — gower","text":"Gower, J. C. (1971). general coefficient similarity properties. Biometrics, 27(4), 857-871. doi:10.2307/2528823","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/gower.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gower distance — gower","text":"","code":"gower(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.2173035                     #> Nose  0.7487885 0.6926051           #> Stool 0.4236432 0.3655145 0.6688246"},{"path":"https://cmmr.github.io/ecodive/reference/hamming.html","id":null,"dir":"Reference","previous_headings":"","what":"Hamming distance — hamming","title":"Hamming distance — hamming","text":"Measures minimum number substitutions required change one string .","code":""},{"path":"https://cmmr.github.io/ecodive/reference/hamming.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hamming distance — hamming","text":"","code":"hamming(counts, margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/hamming.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hamming distance — hamming","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/hamming.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hamming distance — hamming","text":"Hamming distance defined : $$(+ B) - 2J$$ : \\(\\), \\(B\\) : Number features sample. \\(J\\) : Number features common (intersection). Base R Equivalent:","code":"sum(xor(x, y))"},{"path":"https://cmmr.github.io/ecodive/reference/hamming.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hamming distance — hamming","text":"Hamming, R. W. (1950). Error detecting error correcting codes. Bell System Technical Journal, 29(2), 147-160. doi:10.1002/j.1538-7305.1950.tb00463.x","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/hamming.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hamming distance — hamming","text":"","code":"hamming(ex_counts) #>       Saliva Gums Nose #> Gums       1           #> Nose       2    1      #> Stool      3    2    1"},{"path":"https://cmmr.github.io/ecodive/reference/hellinger.html","id":null,"dir":"Reference","previous_headings":"","what":"Hellinger distance — hellinger","title":"Hellinger distance — hellinger","text":"distance metric related Bhattacharyya distance, often used community data many zeros.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/hellinger.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hellinger distance — hellinger","text":"","code":"hellinger(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/hellinger.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hellinger distance — hellinger","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/hellinger.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hellinger distance — hellinger","text":"Hellinger distance defined : $$\\sqrt{\\sum_{=1}^{n}(\\sqrt{P_i} - \\sqrt{Q_i})^{2}}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sqrt(sum((sqrt(x) - sqrt(y)) ^ 2))"},{"path":"https://cmmr.github.io/ecodive/reference/hellinger.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hellinger distance — hellinger","text":"Rao, C. R. (1995). review canonical coordinates alternative correspondence analysis using Hellinger distance. Qüestiió, 19, 23-63. Hellinger, E. (1909). Neue Begründung der Theorie quadratischer Formen von unendlichvielen Veränderlichen. Journal für die reine und angewandte Mathematik, 136, 210–271. doi:10.1515/crll.1909.136.210","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/hellinger.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hellinger distance — hellinger","text":"","code":"hellinger(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.4867106                     #> Nose  1.2935044 1.2732200           #> Stool 1.3170808 1.3273191 1.3417468"},{"path":"https://cmmr.github.io/ecodive/reference/horn.html","id":null,"dir":"Reference","previous_headings":"","what":"Horn-Morisita dissimilarity — horn","title":"Horn-Morisita dissimilarity — horn","text":"similarity index based Simpson's diversity index, suitable abundance data.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/horn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Horn-Morisita dissimilarity — horn","text":"","code":"horn(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/horn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Horn-Morisita dissimilarity — horn","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/horn.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Horn-Morisita dissimilarity — horn","text":"Horn-Morisita dissimilarity defined : $$1 - \\frac{2\\sum_{=1}^{n}P_{}Q_{}}{\\sum_{=1}^{n}P_i^2 + \\sum_{=1}^{n}Q_i^2}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"z <- sum(x^2) / sum(x)^2 + sum(y^2) / sum(y)^2 1 - ((2 * sum(x * y)) / (z * sum(x) * sum(y)))"},{"path":"https://cmmr.github.io/ecodive/reference/horn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Horn-Morisita dissimilarity — horn","text":"Horn, H. S. (1966). Measurement \"overlap\" comparative ecological studies. American Naturalist, 100(914), 419-424. doi:10.1086/282436","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/horn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Horn-Morisita dissimilarity — horn","text":"","code":"horn(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.2765026                     #> Nose  0.9718747 0.9654300           #> Stool 0.9900374 0.9932115 0.9952692"},{"path":"https://cmmr.github.io/ecodive/reference/inv_simpson.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse Simpson Index — inv_simpson","title":"Inverse Simpson Index — inv_simpson","text":"transformation Simpson index represents \"effective number species\".","code":""},{"path":"https://cmmr.github.io/ecodive/reference/inv_simpson.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse Simpson Index — inv_simpson","text":"","code":"inv_simpson(counts, norm = \"percent\", margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/inv_simpson.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse Simpson Index — inv_simpson","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/inv_simpson.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inverse Simpson Index — inv_simpson","text":"Inverse Simpson index defined : $$1 / \\sum_{= 1}^{n} P_i^2$$ : \\(P_i\\) : Proportional abundance \\(\\)-th feature. Base R Equivalent:","code":"p <- x / sum(x) 1 / sum(p ** 2)"},{"path":"https://cmmr.github.io/ecodive/reference/inv_simpson.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Inverse Simpson Index — inv_simpson","text":"Simpson, E. H. (1949). Measurement diversity. Nature, 163, 688. doi:10.1038/163688a0","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/inv_simpson.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inverse Simpson Index — inv_simpson","text":"","code":"inv_simpson(ex_counts) #>   Saliva     Gums     Nose    Stool  #> 2.029446 1.233425 2.783607 1.013125"},{"path":"https://cmmr.github.io/ecodive/reference/jaccard.html","id":null,"dir":"Reference","previous_headings":"","what":"Jaccard distance — jaccard","title":"Jaccard distance — jaccard","text":"Measures dissimilarity sample sets.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/jaccard.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Jaccard distance — jaccard","text":"","code":"jaccard(counts, margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/jaccard.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Jaccard distance — jaccard","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/jaccard.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Jaccard distance — jaccard","text":"Jaccard distance defined : $$1 - \\frac{J}{(+ B - J)}$$ : \\(\\), \\(B\\) : Number features sample. \\(J\\) : Number features common (intersection). Base R Equivalent:","code":"1 - sum(x & y) / sum(x | y)"},{"path":"https://cmmr.github.io/ecodive/reference/jaccard.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Jaccard distance — jaccard","text":"Jaccard, P. (1912). distribution flora alpine zone. New Phytologist, 11(2), 37-50. doi:10.1111/j.1469-8137.1912.tb05611.x Jaccard, P. (1908). Nouvelles recherches sur la distribution florale. Bulletin de la Societe Vaudoise des Sciences Naturelles, 44(163), 223-270. doi:10.5169/seals-268384","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/jaccard.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Jaccard distance — jaccard","text":"","code":"jaccard(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.2000000                     #> Nose  0.3333333 0.1666667           #> Stool 0.5000000 0.3333333 0.1666667"},{"path":"https://cmmr.github.io/ecodive/reference/jensen.html","id":null,"dir":"Reference","previous_headings":"","what":"Jensen-Shannon distance — jensen","title":"Jensen-Shannon distance — jensen","text":"square root Jensen-Shannon divergence.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/jensen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Jensen-Shannon distance — jensen","text":"","code":"jensen(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/jensen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Jensen-Shannon distance — jensen","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/jensen.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Jensen-Shannon distance — jensen","text":"Jensen-Shannon distance defined : $$\\sqrt{\\frac{1}{2}\\left[\\sum_{=1}^{n}P_i\\ln\\left(\\frac{2P_i}{P_i + Q_i}\\right) + \\sum_{=1}^{n}Q_i\\ln\\left(\\frac{2Q_i}{P_i + Q_i}\\right)\\right]}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sqrt(sum(x * log(2 * x / (x+y)), y * log(2 * y / (x+y))) / 2)"},{"path":"https://cmmr.github.io/ecodive/reference/jensen.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Jensen-Shannon distance — jensen","text":"Endres, D. M., & Schindelin, J. E. (2003). new metric probability distributions. IEEE Transactions Information Theory, 49(7), 1858-1860. doi:10.1109/TIT.2003.813506","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/jensen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Jensen-Shannon distance — jensen","text":"","code":"jensen(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.3372738                     #> Nose  0.7949716 0.7922468           #> Stool 0.8151096 0.8171160 0.8194512"},{"path":"https://cmmr.github.io/ecodive/reference/jsd.html","id":null,"dir":"Reference","previous_headings":"","what":"Jensen-Shannon divergence (JSD) — jsd","title":"Jensen-Shannon divergence (JSD) — jsd","text":"symmetrized smoothed version Kullback-Leibler divergence.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/jsd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Jensen-Shannon divergence (JSD) — jsd","text":"","code":"jsd(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/jsd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Jensen-Shannon divergence (JSD) — jsd","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/jsd.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Jensen-Shannon divergence (JSD) — jsd","text":"Jensen-Shannon divergence (JSD) defined : $$\\frac{1}{2}\\left[\\sum_{=1}^{n}P_i\\ln\\left(\\frac{2P_i}{P_i + Q_i}\\right) + \\sum_{=1}^{n}Q_i\\ln\\left(\\frac{2Q_i}{P_i + Q_i}\\right)\\right]$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sum(x * log(2 * x / (x+y)), y * log(2 * y / (x+y))) / 2"},{"path":"https://cmmr.github.io/ecodive/reference/jsd.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Jensen-Shannon divergence (JSD) — jsd","text":"Lin, J. (1991). Divergence measures based Shannon entropy. IEEE Transactions Information Theory, 37(1), 145-151. doi:10.1109/18.61115","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/jsd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Jensen-Shannon divergence (JSD) — jsd","text":"","code":"jsd(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.1137536                     #> Nose  0.6319799 0.6276551           #> Stool 0.6644036 0.6676786 0.6715003"},{"path":"https://cmmr.github.io/ecodive/reference/lorentzian.html","id":null,"dir":"Reference","previous_headings":"","what":"Lorentzian distance — lorentzian","title":"Lorentzian distance — lorentzian","text":"log-based distance metric robust outliers.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/lorentzian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Lorentzian distance — lorentzian","text":"","code":"lorentzian(   counts,   norm = \"percent\",   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/lorentzian.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Lorentzian distance — lorentzian","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/lorentzian.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Lorentzian distance — lorentzian","text":"Lorentzian distance defined : $$\\sum_{=1}^{n}\\ln{(1 + |P_i - Q_i|)}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sum(log(1 + abs(x - y)))"},{"path":"https://cmmr.github.io/ecodive/reference/lorentzian.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Lorentzian distance — lorentzian","text":"Cha, S.-H. (2007). Comprehensive survey distance/similarity measures probability density functions. International Journal Mathematical Models Methods Applied Sciences, 1(4), 300–307.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/lorentzian.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Lorentzian distance — lorentzian","text":"","code":"lorentzian(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.7118288                     #> Nose  1.6221540 1.5523304           #> Stool 1.4957656 1.4214362 1.5388404"},{"path":"https://cmmr.github.io/ecodive/reference/manhattan.html","id":null,"dir":"Reference","previous_headings":"","what":"Manhattan distance — manhattan","title":"Manhattan distance — manhattan","text":"sum absolute differences, also known taxicab geometry.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/manhattan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Manhattan distance — manhattan","text":"","code":"manhattan(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/manhattan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Manhattan distance — manhattan","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/manhattan.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Manhattan distance — manhattan","text":"Manhattan distance defined : $$\\sum_{=1}^{n} |P_i - Q_i|$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sum(abs(x-y))"},{"path":"https://cmmr.github.io/ecodive/reference/manhattan.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Manhattan distance — manhattan","text":"Krause, E. F. (1987). Taxicab geometry: adventure non-Euclidean geometry. Dover Publications.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/manhattan.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Manhattan distance — manhattan","text":"","code":"manhattan(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.8531946                     #> Nose  1.9427687 1.9440511           #> Stool 1.9819017 1.9822093 1.9830354"},{"path":"https://cmmr.github.io/ecodive/reference/margalef.html","id":null,"dir":"Reference","previous_headings":"","what":"Margalef's Richness Index — margalef","title":"Margalef's Richness Index — margalef","text":"richness metric normalizes number species log total sample size.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/margalef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Margalef's Richness Index — margalef","text":"","code":"margalef(counts, margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/margalef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Margalef's Richness Index — margalef","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/margalef.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Margalef's Richness Index — margalef","text":"Margalef's index defined : $$\\frac{n - 1}{\\ln{X_T}}$$ : \\(n\\) : number features. \\(X_T\\) : Total counts (sequencing depth). Base R Equivalent:","code":"(sum(x > 0) - 1) / log(sum(x))"},{"path":"https://cmmr.github.io/ecodive/reference/margalef.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Margalef's Richness Index — margalef","text":"Margalef, R. (1958). Information theory ecology. General Systems, 3, 36-71. Gamito, S. (2010). Caution needed applying Margalef diversity index. Ecological Indicators, 10(2), 550-551. doi:10.1016/j.ecolind.2009.07.006","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/margalef.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Margalef's Richness Index — margalef","text":"","code":"margalef(ex_counts) #>    Saliva      Gums      Nose     Stool  #> 0.5133870 0.5893866 0.7226796 0.6228956"},{"path":"https://cmmr.github.io/ecodive/reference/matusita.html","id":null,"dir":"Reference","previous_headings":"","what":"Matusita distance — matusita","title":"Matusita distance — matusita","text":"distance measure closely related Hellinger distance.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/matusita.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Matusita distance — matusita","text":"","code":"matusita(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/matusita.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Matusita distance — matusita","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/matusita.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Matusita distance — matusita","text":"Matusita distance defined : $$\\sqrt{\\sum_{=1}^{n}\\left(\\sqrt{P_i} - \\sqrt{Q_i}\\right)^2}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sqrt(sum((sqrt(x) - sqrt(y)) ^ 2))"},{"path":"https://cmmr.github.io/ecodive/reference/matusita.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Matusita distance — matusita","text":"Matusita, K. (1955). Decision rules, based distance, problems fit, two samples, estimation. Annals Mathematical Statistics, 26(4), 631-640. doi:10.1214/aoms/1177728422","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/matusita.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Matusita distance — matusita","text":"","code":"matusita(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.4867106                     #> Nose  1.2935044 1.2732200           #> Stool 1.3170808 1.3273191 1.3417468"},{"path":"https://cmmr.github.io/ecodive/reference/mcintosh.html","id":null,"dir":"Reference","previous_headings":"","what":"McIntosh Index — mcintosh","title":"McIntosh Index — mcintosh","text":"dominance index based Euclidean distance origin.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/mcintosh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"McIntosh Index — mcintosh","text":"","code":"mcintosh(counts, margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/mcintosh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"McIntosh Index — mcintosh","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/mcintosh.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"McIntosh Index — mcintosh","text":"McIntosh index defined : $$\\frac{X_T - \\sqrt{\\sum_{= 1}^{n} (X_i)^2}}{X_T - \\sqrt{X_T}}$$ : \\(X_i\\) : Integer count \\(\\)-th feature. \\(X_T\\) : Total counts. Base R Equivalent:","code":"(sum(x) - sqrt(sum(x^2))) / (sum(x) - sqrt(sum(x)))"},{"path":"https://cmmr.github.io/ecodive/reference/mcintosh.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"McIntosh Index — mcintosh","text":"McIntosh, R. P. (1967). index diversity relation certain concepts diversity. Ecology, 48(3), 392-404. doi:10.2307/1932674","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/mcintosh.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"McIntosh Index — mcintosh","text":"","code":"mcintosh(ex_counts) #>      Saliva        Gums        Nose       Stool  #> 0.315000947 0.103044944 0.413637580 0.006771808"},{"path":"https://cmmr.github.io/ecodive/reference/menhinick.html","id":null,"dir":"Reference","previous_headings":"","what":"Menhinick's Richness Index — menhinick","title":"Menhinick's Richness Index — menhinick","text":"richness metric normalizes number species square root total sample size.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/menhinick.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Menhinick's Richness Index — menhinick","text":"","code":"menhinick(counts, margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/menhinick.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Menhinick's Richness Index — menhinick","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/menhinick.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Menhinick's Richness Index — menhinick","text":"Menhinick's index defined : $$\\frac{n}{\\sqrt{X_T}}$$ : \\(n\\) : number features. \\(X_T\\) : Total counts. Base R Equivalent:","code":"sum(x > 0) / sqrt(sum(x))"},{"path":"https://cmmr.github.io/ecodive/reference/menhinick.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Menhinick's Richness Index — menhinick","text":"Menhinick, E. F. (1964). comparison species-individuals diversity indices applied samples field insects. Ecology, 45(4), 859-861. doi:10.2307/1934933","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/menhinick.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Menhinick's Richness Index — menhinick","text":"","code":"menhinick(ex_counts) #>    Saliva      Gums      Nose     Stool  #> 0.2153528 0.1679783 0.1887016 0.2016195"},{"path":"https://cmmr.github.io/ecodive/reference/metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Find and Browse Available Metrics — list_metrics","title":"Find and Browse Available Metrics — list_metrics","text":"Programmatic access lists available metrics, associated functions.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find and Browse Available Metrics — list_metrics","text":"","code":"list_metrics(   div = c(NA, \"alpha\", \"beta\"),   val = c(\"data.frame\", \"list\", \"func\", \"id\", \"name\", \"div\", \"phylo\", \"weighted\",     \"int_only\", \"true_metric\"),   nm = c(NA, \"id\", \"name\"),   phylo = NULL,   weighted = NULL,   int_only = NULL,   true_metric = NULL )  match_metric(   metric,   div = NULL,   phylo = NULL,   weighted = NULL,   int_only = NULL,   true_metric = NULL )"},{"path":"https://cmmr.github.io/ecodive/reference/metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find and Browse Available Metrics — list_metrics","text":"div Filter diversity type. One \"alpha\" \"beta\". Default: NA (filtering). val Sets return value function call. See \"Value\" section . Default: \"data.frame\" nm value use names returned object. Default \"id\" val \"list\" \"func\", otherwise default NA (name). phylo Filter whether phylogenetic tree required. TRUE returns phylogenetic metrics. FALSE returns non-phylogenetic metrics. Default: NULL (filtering). weighted Filter whether relative abundance used. TRUE returns quantitative metrics. FALSE returns qualitative (presence/absence) metrics. Default: NULL (filtering). int_only Filter whether integer counts required. TRUE returns metrics requiring integers (e.g. richness estimators). FALSE returns metrics accept proportions. Default: NULL (filtering). true_metric Filter whether metric satisfies triangle inequality. TRUE returns proper distance metrics. FALSE returns dissimilarities. Default: NULL (filtering). metric name alpha/beta diversity metric search . Supports partial matching. non-alpha characters ignored.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find and Browse Available Metrics — list_metrics","text":"match_metric() list following elements. name : Metric name, e.g. \"Faith's Phylogenetic Diversity\" id : Metric ID - also name function, e.g. \"faith\" div : Either \"alpha\" \"beta\". phylo : TRUE metric requires phylogenetic tree; FALSE otherwise. weighted : TRUE metric takes relative abundance account; FALSE uses presence/absence. int_only : TRUE metric requires integer counts; FALSE otherwise. true_metric : TRUE metric true metric satisfies triangle inequality; FALSE non-metric dissimilarity; NA alpha diversity metrics. func : function metric, e.g. ecodive::faith params : Formal args func, e.g. c(\"counts\", \"tree\", \"cpus\") list_metrics() returned object's type values controlled val nm arguments. val = \"data.frame\" : data.frame options sourced. val = \"list\" : list objects returned match_metric() (). val = \"func\" : list functions. val = \"id\" : character vector metric IDs. val = \"name\" : character vector metric names. val = \"div\" : character vector \"alpha\" /\"beta\". val = \"phylo\" : logical vector indicating metrics require tree. val = \"weighted\" : logical vector indicating metrics take relative abundance account (opposed just presence/absence). val = \"int_only\" : logical vector indicating metrics require integer counts. val = \"true_metric\" : logical vector indicating metrics true metrics satisfy triangle inequality, work better ordinations PCoA. nm set, names vector list metric ID (nm=\"id\") name (nm=\"name\"). val=\"data.frame\", names applied rownames() property data.table.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/metrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find and Browse Available Metrics — list_metrics","text":"","code":"# A data.frame of all available metrics.     head(list_metrics()) #>                                       name            id phylo weighted #> 1 Abundance-based Coverage Estimator (ACE)           ace FALSE     TRUE #> 2                       Aitchison Distance     aitchison FALSE     TRUE #> 3                      Berger-Parker Index        berger FALSE     TRUE #> 4                   Bhattacharyya Distance bhattacharyya FALSE     TRUE #> 5                Bray-Curtis Dissimilarity          bray FALSE     TRUE #> 6                          Brillouin Index     brillouin FALSE     TRUE #>   int_only true_metric   div #> 1     TRUE          NA alpha #> 2    FALSE        TRUE  beta #> 3    FALSE          NA alpha #> 4    FALSE        TRUE  beta #> 5    FALSE       FALSE  beta #> 6     TRUE          NA alpha          # All alpha diversity function names.     list_metrics('alpha', val = 'id') #>  [1] \"ace\"         \"berger\"      \"brillouin\"   \"chao1\"       \"faith\"       #>  [6] \"fisher\"      \"simpson\"     \"inv_simpson\" \"margalef\"    \"mcintosh\"    #> [11] \"menhinick\"   \"observed\"    \"shannon\"     \"squares\"              # Try to find a metric named 'otus'.     m <- match_metric('otus')          # The result is a list that includes the function.     str(m) #> List of 9 #>  $ name       : chr \"Observed Features\" #>  $ id         : chr \"observed\" #>  $ phylo      : logi FALSE #>  $ weighted   : logi FALSE #>  $ int_only   : logi FALSE #>  $ true_metric: logi NA #>  $ div        : chr \"alpha\" #>  $ func       :function (counts, margin = 1L, cpus = n_cpus())   #>  $ params     : chr [1:3] \"counts\" \"margin\" \"cpus\""},{"path":"https://cmmr.github.io/ecodive/reference/minkowski.html","id":null,"dir":"Reference","previous_headings":"","what":"Minkowski distance — minkowski","title":"Minkowski distance — minkowski","text":"generalized metric includes Euclidean Manhattan distance special cases.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/minkowski.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Minkowski distance — minkowski","text":"","code":"minkowski(   counts,   norm = \"percent\",   power = 1.5,   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/minkowski.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Minkowski distance — minkowski","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. power Scaling factor magnitude differences communities (\\(p\\)). Default: 1.5 margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/minkowski.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Minkowski distance — minkowski","text":"Minkowski distance defined : $$\\sqrt[p]{\\sum_{=1}^{n} (P_i - Q_i)^p}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. \\(p\\) : geometry space (power parameter). Parameter: power power parameter (default 1.5) determines value \\(p\\) equation. Special Cases Manhattan distance: \\(p = 1\\), formula reduces sum absolute differences. Euclidean distance: \\(p = 2\\), formula reduces standard straight-line distance. Chebyshev distance: \\(p \\\\infty\\), formula reduces maximum absolute difference. Base R Equivalent:","code":"p <- 1.5 sum(abs(x - y)^p) ^ (1/p)"},{"path":"https://cmmr.github.io/ecodive/reference/minkowski.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Minkowski distance — minkowski","text":"Deza, M. M., & Deza, E. (2009). Encyclopedia distances. Springer. Minkowski, H. (1896). Geometrie der Zahlen. Teubner.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/minkowski.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Minkowski distance — minkowski","text":"","code":"minkowski(ex_counts, power = 2) # Equivalent to Euclidean #>          Saliva      Gums      Nose #> Gums  0.6003499                     #> Nose  0.9099609 1.0628029           #> Stool 1.2103914 1.3362601 1.1575500"},{"path":"https://cmmr.github.io/ecodive/reference/morisita.html","id":null,"dir":"Reference","previous_headings":"","what":"Morisita dissimilarity — morisita","title":"Morisita dissimilarity — morisita","text":"measure overlap samples independent sample size. Requires integer counts.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/morisita.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Morisita dissimilarity — morisita","text":"","code":"morisita(counts, margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/morisita.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Morisita dissimilarity — morisita","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/morisita.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Morisita dissimilarity — morisita","text":"Morisita dissimilarity defined : $$1 - \\frac{2\\sum_{=1}^{n}X_{}Y_{}}{\\left(\\frac{\\sum_{=1}^{n}X_i(X_i - 1)}{X_T(X_T - 1)} + \\frac{\\sum_{=1}^{n}Y_i(Y_i - 1)}{Y_T(Y_T - 1)}\\right)X_{T}Y_{T}}$$ : \\(X_i\\), \\(Y_i\\) : Absolute counts \\(\\)-th feature. \\(X_T\\), \\(Y_T\\) : Total counts sample. \\(X_T = \\sum_{=1}^{n} X_i\\). \\(n\\) : number features. Base R Equivalent:","code":"simp_x <- sum(x * (x - 1)) / (sum(x) * (sum(x) - 1)) simp_y <- sum(y * (y - 1)) / (sum(y) * (sum(y) - 1)) 1 - ((2 * sum(x * y)) / ((simp_x + simp_y) * sum(x) * sum(y)))"},{"path":"https://cmmr.github.io/ecodive/reference/morisita.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Morisita dissimilarity — morisita","text":"Morisita, M. (1959). Measuring interspecific association similarity communities. Memoirs Faculty Science, Kyushu University, Series E (Biology), 3, 65-80.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/morisita.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Morisita dissimilarity — morisita","text":"","code":"morisita(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.2755642                     #> Nose  0.9718049 0.9654050           #> Stool 0.9900273 0.9932106 0.9952669"},{"path":"https://cmmr.github.io/ecodive/reference/motyka.html","id":null,"dir":"Reference","previous_headings":"","what":"Motyka dissimilarity — motyka","title":"Motyka dissimilarity — motyka","text":"Also known Bray-Curtis dissimilarity applied abundance data, formulated slightly differently.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/motyka.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Motyka dissimilarity — motyka","text":"","code":"motyka(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/motyka.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Motyka dissimilarity — motyka","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/motyka.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Motyka dissimilarity — motyka","text":"Motyka dissimilarity defined : $$\\frac{\\sum_{=1}^{n} \\max(P_i, Q_i)}{\\sum_{=1}^{n} (P_i + Q_i)}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sum(pmax(x, y)) / sum(x, y)"},{"path":"https://cmmr.github.io/ecodive/reference/motyka.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Motyka dissimilarity — motyka","text":"Motyka, J. (1947). O celach metodach badan geobotanicznych. Annales Universitatis Mariae Curie-Sklodowska, Sectio C, 3, 1-168.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/motyka.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Motyka dissimilarity — motyka","text":"","code":"motyka(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.7132987                     #> Nose  0.9856922 0.9860128           #> Stool 0.9954754 0.9955523 0.9957588"},{"path":"https://cmmr.github.io/ecodive/reference/n_cpus.html","id":null,"dir":"Reference","previous_headings":"","what":"Number of CPU Cores — n_cpus","title":"Number of CPU Cores — n_cpus","text":"thin wrapper around parallely::availableCores(). parallely package installed, falls back parallel::detectCores(.tests = TRUE, logical = TRUE). Returns 1 pthread support unavailable number cpus determined.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/n_cpus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Number of CPU Cores — n_cpus","text":"","code":"n_cpus()"},{"path":"https://cmmr.github.io/ecodive/reference/n_cpus.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Number of CPU Cores — n_cpus","text":"scalar integer, guaranteed least 1.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/n_cpus.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Number of CPU Cores — n_cpus","text":"","code":"n_cpus() #> [1] 4"},{"path":"https://cmmr.github.io/ecodive/reference/normalized_unifrac.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalized Weighted UniFrac — normalized_unifrac","title":"Normalized Weighted UniFrac — normalized_unifrac","text":"Weighted UniFrac normalized tree length allow comparison trees.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/normalized_unifrac.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalized Weighted UniFrac — normalized_unifrac","text":"","code":"normalized_unifrac(   counts,   tree = NULL,   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/normalized_unifrac.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalized Weighted UniFrac — normalized_unifrac","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. tree phylo-class object representing phylogenetic tree OTUs counts. OTU identifiers given colnames(counts) must present tree. Can omitted tree embedded counts object attr(counts, 'tree'). margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/normalized_unifrac.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Normalized Weighted UniFrac — normalized_unifrac","text":"Normalized Weighted UniFrac distance defined : $$\\frac{\\sum_{=1}^{n} L_i|P_i - Q_i|}{\\sum_{=1}^{n} L_i(P_i + Q_i)}$$ : \\(n\\) : number branches tree. \\(L_i\\) : length \\(\\)-th branch. \\(P_i\\), \\(Q_i\\) : proportion community descending branch \\(\\) sample P Q.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/normalized_unifrac.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Normalized Weighted UniFrac — normalized_unifrac","text":"Lozupone, C. ., Hamady, M., Kelley, S. T., & Knight, R. (2007). Quantitative qualitative beta diversity measures lead different insights factors structure microbial communities. Applied Environmental Microbiology, 73(5), 1576-1585. doi:10.1128/AEM.01996-06","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/normalized_unifrac.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalized Weighted UniFrac — normalized_unifrac","text":"","code":"normalized_unifrac(ex_counts, tree = ex_tree) #>          Saliva      Gums      Nose #> Gums  0.4343436                     #> Nose  0.7891160 0.6714592           #> Stool 0.9707293 0.9868636 0.9925679"},{"path":"https://cmmr.github.io/ecodive/reference/observed.html","id":null,"dir":"Reference","previous_headings":"","what":"Observed Features — observed","title":"Observed Features — observed","text":"count unique features (richness) sample.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/observed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Observed Features — observed","text":"","code":"observed(counts, margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/observed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Observed Features — observed","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/observed.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Observed Features — observed","text":"Observed features defined simply number features non-zero abundance: $$n$$ Base R Equivalent:","code":"sum(x > 0)"},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/observed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Observed Features — observed","text":"","code":"observed(ex_counts) #> Saliva   Gums   Nose  Stool  #>      4      5      6      5"},{"path":"https://cmmr.github.io/ecodive/reference/ochiai.html","id":null,"dir":"Reference","previous_headings":"","what":"Otsuka-Ochiai dissimilarity — ochiai","title":"Otsuka-Ochiai dissimilarity — ochiai","text":"Also known cosine similarity binary data.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/ochiai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Otsuka-Ochiai dissimilarity — ochiai","text":"","code":"ochiai(counts, margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/ochiai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Otsuka-Ochiai dissimilarity — ochiai","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/ochiai.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Otsuka-Ochiai dissimilarity — ochiai","text":"Otsuka-Ochiai dissimilarity defined : $$1 - \\frac{J}{\\sqrt{AB}}$$ : \\(\\), \\(B\\) : Number features sample. \\(J\\) : Number features common (intersection). Base R Equivalent:","code":"1 - sum(x & y) / sqrt(sum(x>0) * sum(y>0))"},{"path":"https://cmmr.github.io/ecodive/reference/ochiai.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Otsuka-Ochiai dissimilarity — ochiai","text":"Ochiai, . (1957). Zoogeographic studies soleoid fishes found Japan neighbouring regions. Bulletin Japanese Society Scientific Fisheries, 22, 526-530.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/ochiai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Otsuka-Ochiai dissimilarity — ochiai","text":"","code":"ochiai(ex_counts) #>           Saliva       Gums       Nose #> Gums  0.10557281                       #> Nose  0.18350342 0.08712907            #> Stool 0.32917961 0.20000000 0.08712907"},{"path":"https://cmmr.github.io/ecodive/reference/psym_chisq.html","id":null,"dir":"Reference","previous_headings":"","what":"Probabilistic Symmetric Chi-Squared distance — psym_chisq","title":"Probabilistic Symmetric Chi-Squared distance — psym_chisq","text":"chi-squared based distance metric comparing probability distributions.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/psym_chisq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probabilistic Symmetric Chi-Squared distance — psym_chisq","text":"","code":"psym_chisq(   counts,   norm = \"percent\",   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/psym_chisq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Probabilistic Symmetric Chi-Squared distance — psym_chisq","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/psym_chisq.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Probabilistic Symmetric Chi-Squared distance — psym_chisq","text":"Probabilistic Symmetric \\(\\chi^2\\) distance defined : $$2\\sum_{=1}^{n}\\frac{(P_i - Q_i)^2}{P_i + Q_i}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"2 * sum((x - y)^2 / (x + y))"},{"path":"https://cmmr.github.io/ecodive/reference/psym_chisq.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Probabilistic Symmetric Chi-Squared distance — psym_chisq","text":"Cha, S.-H. (2007). Comprehensive survey distance/similarity measures probability density functions. International Journal Mathematical Models Methods Applied Sciences, 1(4), 300–307.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/psym_chisq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Probabilistic Symmetric Chi-Squared distance — psym_chisq","text":"","code":"psym_chisq(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.8481868                     #> Nose  3.7831387 3.7855551           #> Stool 3.9279613 3.9329354 3.9390787"},{"path":"https://cmmr.github.io/ecodive/reference/rarefy.html","id":null,"dir":"Reference","previous_headings":"","what":"Rarefy OTU counts. — rarefy","title":"Rarefy OTU counts. — rarefy","text":"Sub-sample OTU observations samples equal number. called data non-integer abundances, values re-scaled integers 1 depth sum depth.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/rarefy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rarefy OTU counts. — rarefy","text":"","code":"rarefy(   counts,   depth = 0.1,   n_samples = NULL,   seed = 0,   times = NULL,   drop = TRUE,   margin = 1L,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/rarefy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rarefy OTU counts. — rarefy","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. depth many observations keep per sample. 0 < depth < 1, taken minimum percentage dataset's observations keep. Ignored n_samples specified. Default: 0.1 n_samples number samples keep. 0 < n_samples < 1, taken percentage samples keep. negative, number samples dropped. 0, samples kept. NULL, depth used instead. Default: NULL seed integer seed randomizing observations keep drop. need create different random rarefactions data, set seed different number time. Default: 0 times many independent rarefactions perform. set, rarefy() return list matrices. seeds matrix sequential, starting seed. Default: NULL drop Drop rows columns zero observations rarefying. Default: TRUE margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/rarefy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rarefy OTU counts. — rarefy","text":"rarefied matrix. Matrix slam objects returned type; otherwise base R matrix returned.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/rarefy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rarefy OTU counts. — rarefy","text":"","code":"# A 4-sample x 5-OTU matrix with samples in rows.     counts <- matrix(c(0,0,0,0,0,8,9,10,5,5,5,5,2,0,0,0,6,5,7,0), 4, 5,       dimnames = list(LETTERS[1:4], paste0('OTU', 1:5)))     counts #>   OTU1 OTU2 OTU3 OTU4 OTU5 #> A    0    0    5    2    6 #> B    0    8    5    0    5 #> C    0    9    5    0    7 #> D    0   10    5    0    0     rowSums(counts) #>  A  B  C  D  #> 13 18 21 15           # Rarefy all samples to a depth of 13.     # Note that sample 'A' has 0 counts and is dropped.     r_mtx <- rarefy(counts, depth = 13, seed = 1)     r_mtx #>   OTU2 OTU3 OTU4 OTU5 #> A    0    5    2    6 #> B    4    4    0    5 #> C    3    5    0    5 #> D   10    3    0    0     rowSums(r_mtx) #>  A  B  C  D  #> 13 13 13 13           # Keep zero-sum rows and columns by setting `drop = FALSE`.     rarefy(counts, depth = 13, drop = FALSE, seed = 1) #>   OTU1 OTU2 OTU3 OTU4 OTU5 #> A    0    0    5    2    6 #> B    0    4    4    0    5 #> C    0    3    5    0    5 #> D    0   10    3    0    0          # Rarefy to the depth of the 2nd most abundant sample (B, depth=22).     rarefy(counts, n_samples = 2, seed = 1) #>   OTU2 OTU3 OTU5 #> B    8    5    5 #> C    6    5    7          # Perform 3 independent rarefactions.     r_list <- rarefy(counts, depth = 13, times = 3, seed = 1)     length(r_list) #> [1] 3     r_list[[1]] #>   OTU2 OTU3 OTU4 OTU5 #> A    0    5    2    6 #> B    4    4    0    5 #> C    3    5    0    5 #> D   10    3    0    0          # The class of the input matrix is preserved.     if (requireNamespace('Matrix', quietly = TRUE)) {       counts_dgC <- Matrix::Matrix(counts, sparse = TRUE)       class(counts_dgC)       r_dgC <- rarefy(counts_dgC, depth = 13, seed = 1)       class(r_dgC)     } #> [1] \"dgCMatrix\" #> attr(,\"package\") #> [1] \"Matrix\""},{"path":"https://cmmr.github.io/ecodive/reference/read_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a newick formatted phylogenetic tree. — read_tree","title":"Read a newick formatted phylogenetic tree. — read_tree","text":"phylogenetic tree required computing UniFrac distance matrices. can load tree file providing tree string directly. tree must Newick format, also known parenthetic format New Hampshire format.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/read_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a newick formatted phylogenetic tree. — read_tree","text":"","code":"read_tree(newick, underscores = FALSE)"},{"path":"https://cmmr.github.io/ecodive/reference/read_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a newick formatted phylogenetic tree. — read_tree","text":"newick Input data either file path, URL, Newick string. Compressed (gzip bzip2) files also supported. underscores TRUE, underscores unquoted names remain underscores. FALSE, underscores unquoted named converted spaces.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/read_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read a newick formatted phylogenetic tree. — read_tree","text":"phylo class object representing tree.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/read_tree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read a newick formatted phylogenetic tree. — read_tree","text":"","code":"tree <- read_tree(\"         (A:0.99,((B:0.87,C:0.89):0.51,(((D:0.16,(E:0.83,F:0.96)         :0.94):0.69,(G:0.92,(H:0.62,I:0.85):0.54):0.23):0.74,J:0.1         2):0.43):0.67);\")     class(tree) #> [1] \"phylo\""},{"path":"https://cmmr.github.io/ecodive/reference/shannon.html","id":null,"dir":"Reference","previous_headings":"","what":"Shannon Diversity Index — shannon","title":"Shannon Diversity Index — shannon","text":"commonly used diversity index accounting abundance evenness.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/shannon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shannon Diversity Index — shannon","text":"","code":"shannon(counts, norm = \"percent\", margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/shannon.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Shannon Diversity Index — shannon","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/shannon.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Shannon Diversity Index — shannon","text":"Shannon index (entropy) defined : $$-\\sum_{= 1}^{n} P_i \\times \\ln(P_i)$$ : \\(P_i\\) : Proportional abundance \\(\\)-th feature. Base R Equivalent:","code":"p <- x / sum(x) -sum(p * log(p))"},{"path":"https://cmmr.github.io/ecodive/reference/shannon.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Shannon Diversity Index — shannon","text":"Shannon, C. E. (1948). mathematical theory communication. Bell System Technical Journal, 27, 379-423. Shannon, C. E., & Weaver, W. (1949). Mathematical Theory Communication. University Illinois Press.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/shannon.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Shannon Diversity Index — shannon","text":"","code":"shannon(ex_counts) #>     Saliva       Gums       Nose      Stool  #> 0.74119910 0.36684449 1.14222899 0.04824952"},{"path":"https://cmmr.github.io/ecodive/reference/simpson.html","id":null,"dir":"Reference","previous_headings":"","what":"Gini-Simpson Index — simpson","title":"Gini-Simpson Index — simpson","text":"probability two entities taken random dataset represent different types.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/simpson.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gini-Simpson Index — simpson","text":"","code":"simpson(counts, norm = \"percent\", margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/simpson.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gini-Simpson Index — simpson","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/simpson.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Gini-Simpson Index — simpson","text":"Gini-Simpson index defined : $$1 - \\sum_{= 1}^{n} P_i^2$$ : \\(P_i\\) : Proportional abundance \\(\\)-th feature. Base R Equivalent:","code":"p <- x / sum(x) 1 - sum(p ** 2)"},{"path":"https://cmmr.github.io/ecodive/reference/simpson.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Gini-Simpson Index — simpson","text":"Simpson, E. H. (1949). Measurement diversity. Nature, 163, 688. doi:10.1038/163688a0","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/simpson.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gini-Simpson Index — simpson","text":"","code":"simpson(ex_counts) #>     Saliva       Gums       Nose      Stool  #> 0.50725478 0.18924937 0.64075388 0.01295525"},{"path":"https://cmmr.github.io/ecodive/reference/soergel.html","id":null,"dir":"Reference","previous_headings":"","what":"Soergel distance — soergel","title":"Soergel distance — soergel","text":"distance metric related Bray-Curtis Jaccard indices.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/soergel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Soergel distance — soergel","text":"","code":"soergel(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/soergel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Soergel distance — soergel","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/soergel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Soergel distance — soergel","text":"Soergel distance defined : $$\\frac{\\sum_{=1}^{n} |P_i - Q_i|}{\\sum_{=1}^{n} \\max(P_i, Q_i)}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sum(abs(x - y)) / sum(pmax(x, y))"},{"path":"https://cmmr.github.io/ecodive/reference/soergel.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Soergel distance — soergel","text":"Cha, S.-H. (2007). Comprehensive survey distance/similarity measures probability density functions. International Journal Mathematical Models Methods Applied Sciences, 1(4), 300–307.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/soergel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Soergel distance — soergel","text":"","code":"soergel(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.5980627                     #> Nose  0.9854845 0.9858144           #> Stool 0.9954549 0.9955324 0.9957408"},{"path":"https://cmmr.github.io/ecodive/reference/sorensen.html","id":null,"dir":"Reference","previous_headings":"","what":"Dice-Sorensen dissimilarity — sorensen","title":"Dice-Sorensen dissimilarity — sorensen","text":"statistic used comparing similarity two samples.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/sorensen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dice-Sorensen dissimilarity — sorensen","text":"","code":"sorensen(counts, margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/sorensen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dice-Sorensen dissimilarity — sorensen","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/sorensen.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dice-Sorensen dissimilarity — sorensen","text":"Dice-Sorensen dissimilarity defined : $$\\frac{2J}{(+ B)}$$ : \\(\\), \\(B\\) : Number features sample. \\(J\\) : Number features common (intersection). Base R Equivalent:","code":"2 * sum(x & y) / sum(x>0, y>0)"},{"path":"https://cmmr.github.io/ecodive/reference/sorensen.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Dice-Sorensen dissimilarity — sorensen","text":"Sørensen, T. (1948). method establishing groups equal amplitude plant sociology based similarity species content. Kongelige Danske Videnskabernes Selskab, Biologiske Skrifter, 5, 1-34. Dice, L. R. (1945). Measures amount ecologic association species. Ecology, 26(3), 297–302. doi:10.2307/1932409","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/sorensen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dice-Sorensen dissimilarity — sorensen","text":"","code":"sorensen(ex_counts) #>           Saliva       Gums       Nose #> Gums  0.11111111                       #> Nose  0.20000000 0.09090909            #> Stool 0.33333333 0.20000000 0.09090909"},{"path":"https://cmmr.github.io/ecodive/reference/squared_chisq.html","id":null,"dir":"Reference","previous_headings":"","what":"Squared Chi-Squared distance — squared_chisq","title":"Squared Chi-Squared distance — squared_chisq","text":"squared version Chi-Squared distance.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/squared_chisq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Squared Chi-Squared distance — squared_chisq","text":"","code":"squared_chisq(   counts,   norm = \"percent\",   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/squared_chisq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Squared Chi-Squared distance — squared_chisq","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/squared_chisq.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Squared Chi-Squared distance — squared_chisq","text":"Squared \\(\\chi^2\\) distance defined : $$\\sum_{=1}^{n}\\frac{(P_i - Q_i)^2}{P_i + Q_i}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sum((x - y)^2 / (x + y))"},{"path":"https://cmmr.github.io/ecodive/reference/squared_chisq.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Squared Chi-Squared distance — squared_chisq","text":"Cha, S.-H. (2007). Comprehensive survey distance/similarity measures probability density functions. International Journal Mathematical Models Methods Applied Sciences, 1(4), 300–307.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/squared_chisq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Squared Chi-Squared distance — squared_chisq","text":"","code":"squared_chisq(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.4240934                     #> Nose  1.8915694 1.8927775           #> Stool 1.9639806 1.9664677 1.9695393"},{"path":"https://cmmr.github.io/ecodive/reference/squared_chord.html","id":null,"dir":"Reference","previous_headings":"","what":"Squared Chord distance — squared_chord","title":"Squared Chord distance — squared_chord","text":"squared version Chord distance.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/squared_chord.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Squared Chord distance — squared_chord","text":"","code":"squared_chord(   counts,   norm = \"percent\",   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/squared_chord.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Squared Chord distance — squared_chord","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/squared_chord.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Squared Chord distance — squared_chord","text":"Squared Chord distance defined : $$\\sum_{=1}^{n}\\left(\\sqrt{P_i} - \\sqrt{Q_i}\\right)^2$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sum((sqrt(x) - sqrt(y)) ^ 2)"},{"path":"https://cmmr.github.io/ecodive/reference/squared_chord.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Squared Chord distance — squared_chord","text":"Legendre, P., & Legendre, L. (2012). Numerical ecology. Elsevier.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/squared_chord.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Squared Chord distance — squared_chord","text":"","code":"squared_chord(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.2368872                     #> Nose  1.6731536 1.6210892           #> Stool 1.7347018 1.7617761 1.8002844"},{"path":"https://cmmr.github.io/ecodive/reference/squared_euclidean.html","id":null,"dir":"Reference","previous_headings":"","what":"Squared Euclidean distance — squared_euclidean","title":"Squared Euclidean distance — squared_euclidean","text":"squared Euclidean distance two vectors.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/squared_euclidean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Squared Euclidean distance — squared_euclidean","text":"","code":"squared_euclidean(   counts,   norm = \"percent\",   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/squared_euclidean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Squared Euclidean distance — squared_euclidean","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/squared_euclidean.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Squared Euclidean distance — squared_euclidean","text":"Squared Euclidean distance defined : $$\\sum_{=1}^{n} (P_i - Q_i)^2$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sum((x-y)^2)"},{"path":"https://cmmr.github.io/ecodive/reference/squared_euclidean.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Squared Euclidean distance — squared_euclidean","text":"Legendre, P., & Legendre, L. (2012). Numerical ecology. Elsevier.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/squared_euclidean.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Squared Euclidean distance — squared_euclidean","text":"","code":"squared_euclidean(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.3604200                     #> Nose  0.8280288 1.1295500           #> Stool 1.4650474 1.7855911 1.3399219"},{"path":"https://cmmr.github.io/ecodive/reference/squares.html","id":null,"dir":"Reference","previous_headings":"","what":"Squares Richness Estimator — squares","title":"Squares Richness Estimator — squares","text":"richness estimator based concept \"squares\" (counts species observed twice).","code":""},{"path":"https://cmmr.github.io/ecodive/reference/squares.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Squares Richness Estimator — squares","text":"","code":"squares(counts, margin = 1L, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/squares.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Squares Richness Estimator — squares","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/squares.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Squares Richness Estimator — squares","text":"Squares estimator defined : $$n + \\frac{(F_1)^2 \\sum_{=1}^{n} (X_i)^2}{X_T^2 - nF_1}$$ : \\(n\\) : number observed features. \\(X_T\\) : Total counts. \\(F_1\\) : Number features observed (singletons). \\(X_i\\) : Integer count \\(\\)-th feature. Base R Equivalent:","code":"N  <- sum(x)      # sampling depth S  <- sum(x > 0)  # observed features F1 <- sum(x == 1) # singletons S + ((sum(x^2) * (F1^2)) / ((N^2) - F1 * S))"},{"path":"https://cmmr.github.io/ecodive/reference/squares.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Squares Richness Estimator — squares","text":"Alroy, J. (2018). Limits species richness estimates based subsampling. Paleobiology, 44(2), 177-194. doi:10.1017/pab.2017.38","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/squares.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Squares Richness Estimator — squares","text":"","code":"squares(ex_counts) #>    Saliva      Gums      Nose     Stool  #>  4.492762  8.243044  6.000000 20.793551"},{"path":"https://cmmr.github.io/ecodive/reference/topsoe.html","id":null,"dir":"Reference","previous_headings":"","what":"Topsoe distance — topsoe","title":"Topsoe distance — topsoe","text":"symmetric divergence measure based Jensen-Shannon divergence.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/topsoe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Topsoe distance — topsoe","text":"","code":"topsoe(counts, norm = \"percent\", margin = 1L, pairs = NULL, cpus = n_cpus())"},{"path":"https://cmmr.github.io/ecodive/reference/topsoe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Topsoe distance — topsoe","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/topsoe.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Topsoe distance — topsoe","text":"Topsoe distance defined : $$\\sum_{=1}^{n}P_i\\ln\\left(\\frac{2P_i}{P_i + Q_i}\\right) + \\sum_{=1}^{n}Q_i\\ln\\left(\\frac{2Q_i}{P_i + Q_i}\\right)$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sum(x * log(2 * x / (x+y)), y * log(2 * y / (x+y)))"},{"path":"https://cmmr.github.io/ecodive/reference/topsoe.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Topsoe distance — topsoe","text":"Topsoe, F. (2000). inequalities information divergence related measures discrimination. IEEE Transactions Information Theory, 46(4), 1602-1609. doi:10.1109/18.850703","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/topsoe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Topsoe distance — topsoe","text":"","code":"topsoe(ex_counts) #>          Saliva      Gums      Nose #> Gums  0.2275073                     #> Nose  1.2639597 1.2553101           #> Stool 1.3288072 1.3353573 1.3430006"},{"path":"https://cmmr.github.io/ecodive/reference/unweighted_unifrac.html","id":null,"dir":"Reference","previous_headings":"","what":"Unweighted UniFrac — unweighted_unifrac","title":"Unweighted UniFrac — unweighted_unifrac","text":"phylogenetic distance metric accounts presence/absence lineages.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/unweighted_unifrac.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Unweighted UniFrac — unweighted_unifrac","text":"","code":"unweighted_unifrac(   counts,   tree = NULL,   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/unweighted_unifrac.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Unweighted UniFrac — unweighted_unifrac","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. tree phylo-class object representing phylogenetic tree OTUs counts. OTU identifiers given colnames(counts) must present tree. Can omitted tree embedded counts object attr(counts, 'tree'). margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/unweighted_unifrac.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Unweighted UniFrac — unweighted_unifrac","text":"Unweighted UniFrac distance defined : $$\\frac{1}{n}\\sum_{=1}^{n} L_i|A_i - B_i|$$ : \\(n\\) : number branches tree. \\(L_i\\) : length \\(\\)-th branch. \\(A_i\\), \\(B_i\\) : Binary values (0 1) indicating descendants branch \\(\\) present sample B.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/unweighted_unifrac.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Unweighted UniFrac — unweighted_unifrac","text":"Lozupone, C., & Knight, R. (2005). UniFrac: new phylogenetic method comparing microbial communities. Applied Environmental Microbiology, 71(12), 8228-8235. doi:10.1128/AEM.71.12.8228-8235.2005","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/unweighted_unifrac.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Unweighted UniFrac — unweighted_unifrac","text":"","code":"unweighted_unifrac(ex_counts, tree = ex_tree) #>           Saliva       Gums       Nose #> Gums  0.05759162                       #> Nose  0.16279070 0.11162791            #> Stool 0.22325581 0.17209302 0.06046512"},{"path":"https://cmmr.github.io/ecodive/reference/variance_adjusted_unifrac.html","id":null,"dir":"Reference","previous_headings":"","what":"Variance-Adjusted Weighted UniFrac — variance_adjusted_unifrac","title":"Variance-Adjusted Weighted UniFrac — variance_adjusted_unifrac","text":"weighted UniFrac adjusts expected variance metric.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/variance_adjusted_unifrac.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variance-Adjusted Weighted UniFrac — variance_adjusted_unifrac","text":"","code":"variance_adjusted_unifrac(   counts,   tree = NULL,   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/variance_adjusted_unifrac.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variance-Adjusted Weighted UniFrac — variance_adjusted_unifrac","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. tree phylo-class object representing phylogenetic tree OTUs counts. OTU identifiers given colnames(counts) must present tree. Can omitted tree embedded counts object attr(counts, 'tree'). margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/variance_adjusted_unifrac.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Variance-Adjusted Weighted UniFrac — variance_adjusted_unifrac","text":"Variance-Adjusted Weighted UniFrac distance defined : $$\\frac{\\sum_{=1}^{n} L_i\\frac{|P_i - Q_i|}{\\sqrt{(P_i + Q_i)(2 - P_i - Q_i)}} }{\\sum_{=1}^{n} L_i\\frac{P_i + Q_i}{\\sqrt{(P_i + Q_i)(2 - P_i - Q_i)}} }$$ : \\(n\\) : number branches tree. \\(L_i\\) : length \\(\\)-th branch. \\(P_i\\), \\(Q_i\\) : proportion community descending branch \\(\\) sample P Q.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/variance_adjusted_unifrac.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Variance-Adjusted Weighted UniFrac — variance_adjusted_unifrac","text":"Chang, Q., Luan, Y., & Sun, F. (2011). Variance adjusted weighted UniFrac: powerful beta diversity measure comparing communities based phylogeny. BMC Bioinformatics, 12, 118. doi:10.1186/1471-2105-12-118","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/variance_adjusted_unifrac.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Variance-Adjusted Weighted UniFrac — variance_adjusted_unifrac","text":"","code":"variance_adjusted_unifrac(ex_counts, tree = ex_tree) #>          Saliva      Gums      Nose #> Gums  0.4242631                     #> Nose  0.7753369 0.5565010           #> Stool 0.9655749 0.9807634 0.9785147"},{"path":"https://cmmr.github.io/ecodive/reference/wave_hedges.html","id":null,"dir":"Reference","previous_headings":"","what":"Wave Hedges distance — wave_hedges","title":"Wave Hedges distance — wave_hedges","text":"distance metric derived Hedges' distance.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/wave_hedges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wave Hedges distance — wave_hedges","text":"","code":"wave_hedges(   counts,   norm = \"percent\",   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/wave_hedges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wave Hedges distance — wave_hedges","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. norm Normalize incoming counts. Options : 'percent': Relative abundance (sample abundances sum 1). 'binary': Unweighted presence/absence (count either 0 1). 'clr': Centered log ratio. 'none': transformation. Default: 'percent', expected input formulas. margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/wave_hedges.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Wave Hedges distance — wave_hedges","text":"Wave Hedges distance defined : $$\\frac{\\sum_{=1}^{n} |P_i - Q_i|}{\\sum_{=1}^{n} \\max(P_i, Q_i)}$$ : \\(P_i\\), \\(Q_i\\) : Proportional abundances \\(\\)-th feature. \\(n\\) : number features. Base R Equivalent:","code":"sum(abs(x - y) / pmax(x, y))"},{"path":"https://cmmr.github.io/ecodive/reference/wave_hedges.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Wave Hedges distance — wave_hedges","text":"Cha, S.-H. (2007). Comprehensive survey distance/similarity measures probability density functions. International Journal Mathematical Models Methods Applied Sciences, 1(4), 300–307.","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/wave_hedges.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wave Hedges distance — wave_hedges","text":"","code":"wave_hedges(ex_counts) #>         Saliva     Gums     Nose #> Gums  3.118989                   #> Nose  5.596945 5.507980          #> Stool 5.987586 5.282949 5.091068"},{"path":"https://cmmr.github.io/ecodive/reference/weighted_unifrac.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted UniFrac — weighted_unifrac","title":"Weighted UniFrac — weighted_unifrac","text":"phylogenetic distance metric accounts relative abundance lineages.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/weighted_unifrac.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted UniFrac — weighted_unifrac","text":"","code":"weighted_unifrac(   counts,   tree = NULL,   margin = 1L,   pairs = NULL,   cpus = n_cpus() )"},{"path":"https://cmmr.github.io/ecodive/reference/weighted_unifrac.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted UniFrac — weighted_unifrac","text":"counts numeric matrix count data (samples \\(\\times\\) features). Also supports phyloseq, rbiom, SummarizedExperiment, TreeSummarizedExperiment objects. See vignette('performance') optimizing large datasets. tree phylo-class object representing phylogenetic tree OTUs counts. OTU identifiers given colnames(counts) must present tree. Can omitted tree embedded counts object attr(counts, 'tree'). margin samples matrix's rows, set 1L. samples columns, set 2L. Ignored counts special object class (e.g. phyloseq). Default: 1L pairs combinations samples distances calculated ? default value (NULL) calculates -vs-. Provide numeric logical vector specifying positions distance matrix calculate. See examples. cpus many parallel processing threads used. default, n_cpus(), use logical CPU cores.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/weighted_unifrac.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Weighted UniFrac — weighted_unifrac","text":"Weighted UniFrac distance defined : $$\\sum_{=1}^{n} L_i|P_i - Q_i|$$ : \\(n\\) : number branches tree. \\(L_i\\) : length \\(\\)-th branch. \\(P_i\\), \\(Q_i\\) : proportion community descending branch \\(\\) sample P Q.","code":""},{"path":"https://cmmr.github.io/ecodive/reference/weighted_unifrac.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Weighted UniFrac — weighted_unifrac","text":"Lozupone, C. ., Hamady, M., Kelley, S. T., & Knight, R. (2007). Quantitative qualitative beta diversity measures lead different insights factors structure microbial communities. Applied Environmental Microbiology, 73(5), 1576-1585. doi:10.1128/AEM.01996-06","code":""},{"path":[]},{"path":"https://cmmr.github.io/ecodive/reference/weighted_unifrac.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Weighted UniFrac — weighted_unifrac","text":"","code":"weighted_unifrac(ex_counts, tree = ex_tree) #>          Saliva      Gums      Nose #> Gums   37.08021                     #> Nose   67.00360  55.56710           #> Stool 110.25564 109.96250 110.14056"},{"path":"https://cmmr.github.io/ecodive/news/index.html","id":"ecodive-223","dir":"Changelog","previous_headings":"","what":"ecodive 2.2.3","title":"ecodive 2.2.3","text":"Coerce counts double rarefaction.","code":""},{"path":"https://cmmr.github.io/ecodive/news/index.html","id":"ecodive-222","dir":"Changelog","previous_headings":"","what":"ecodive 2.2.2","title":"ecodive 2.2.2","text":"CRAN release: 2026-01-16 Drop explicit zeroes sparse matrices rarefaction.","code":""},{"path":"https://cmmr.github.io/ecodive/news/index.html","id":"ecodive-221","dir":"Changelog","previous_headings":"","what":"ecodive 2.2.1","title":"ecodive 2.2.1","text":"CRAN release: 2025-12-12 Corrected CRAN rchk issue.","code":""},{"path":"https://cmmr.github.io/ecodive/news/index.html","id":"ecodive-220","dir":"Changelog","previous_headings":"","what":"ecodive 2.2.0","title":"ecodive 2.2.0","text":"CRAN release: 2025-12-03 Dedicated rarefaction backends dense sparse matrices. Auto-conversion col-major sparse matrix distance/diversity calculations.","code":""},{"path":"https://cmmr.github.io/ecodive/news/index.html","id":"ecodive-210","dir":"Changelog","previous_headings":"","what":"ecodive 2.1.0","title":"ecodive 2.1.0","text":"CRAN release: 2025-09-26","code":""},{"path":"https://cmmr.github.io/ecodive/news/index.html","id":"breaking-changes-2-1-0","dir":"Changelog","previous_headings":"","what":"Breaking Changes","title":"ecodive 2.1.0","text":"rescale parameter superseded norm parameter.","code":""},{"path":"https://cmmr.github.io/ecodive/news/index.html","id":"fixes-2-1-0","dir":"Changelog","previous_headings":"","what":"Fixes","title":"ecodive 2.1.0","text":"alpha_div() beta_div() forward applicable parameters. longer crashes pairs = integer(0). pseudocount = NULL correctly selects smallest non-zero count.","code":""},{"path":"https://cmmr.github.io/ecodive/news/index.html","id":"ecodive-200","dir":"Changelog","previous_headings":"","what":"ecodive 2.0.0","title":"ecodive 2.0.0","text":"CRAN release: 2025-09-21","code":""},{"path":"https://cmmr.github.io/ecodive/news/index.html","id":"breaking-changes-2-0-0","dir":"Changelog","previous_headings":"","what":"Breaking Changes","title":"ecodive 2.0.0","text":"Input matrix now samples rows. Removed weighted parameter.","code":""},{"path":"https://cmmr.github.io/ecodive/news/index.html","id":"added-new-diversity-methods-2-0-0","dir":"Changelog","previous_headings":"","what":"Added New Diversity Methods","title":"ecodive 2.0.0","text":"Updated Alpha Options: c(\"ace\", \"berger\", \"brillouin\", \"chao1\", \"faith\", \"fisher\", \"simpson\", \"inv_simpson\", \"margalef\", \"mcintosh\", \"menhinick\", \"observed\", \"shannon\", \"squares\") Updated Beta Options: c(\"aitchison\", \"bhattacharyya\", \"bray\", \"canberra\", \"chebyshev\", \"chord\", \"clark\", \"sorensen\", \"divergence\", \"euclidean\", \"generalized_unifrac\", \"gower\", \"hamming\", \"hellinger\", \"horn\", \"jaccard\", \"jensen\", \"jsd\", \"lorentzian\", \"manhattan\", \"matusita\", \"minkowski\", \"morisita\", \"motyka\", \"normalized_unifrac\", \"ochiai\", \"psym_chisq\", \"soergel\", \"squared_chisq\", \"squared_chord\", \"squared_euclidean\", \"topsoe\", \"unweighted_unifrac\", \"variance_adjusted_unifrac\", \"wave_hedges\", \"weighted_unifrac\")","code":""},{"path":"https://cmmr.github.io/ecodive/news/index.html","id":"ecodive-100","dir":"Changelog","previous_headings":"","what":"ecodive 1.0.0","title":"ecodive 1.0.0","text":"CRAN release: 2025-08-22 first release ecodive.","code":""}]
