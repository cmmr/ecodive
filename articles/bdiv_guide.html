<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Selecting a Beta Diversity Metric • ecodive</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Noto_Sans-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Selecting a Beta Diversity Metric">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecodive</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9009</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/ecodive.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/adiv.html">Alpha Diversity</a></li>
    <li><a class="dropdown-item" href="../articles/bdiv_guide.html">Selecting a Beta Diversity Metric</a></li>
    <li><a class="dropdown-item" href="../articles/bdiv.html">Beta Diversity</a></li>
    <li><a class="dropdown-item" href="../articles/benchmark.html">Benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/unifrac.html">UniFrac Calculations</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cmmr/ecodive/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Selecting a Beta Diversity Metric</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cmmr/ecodive/blob/main/vignettes/bdiv_guide.Rmd" class="external-link"><code>vignettes/bdiv_guide.Rmd</code></a></small>
      <div class="d-none name"><code>bdiv_guide.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="a-practical-guide-to-metric-selection-aligning-method-with-research-question">A Practical Guide to Metric Selection:<br>Aligning Method with
Research Question<a class="anchor" aria-label="anchor" href="#a-practical-guide-to-metric-selection-aligning-method-with-research-question"></a>
</h2>
<p>The theoretical and mathematical properties of the various beta
diversity metrics provide the foundation for making an informed choice.
However, the ultimate decision must be driven by the specific research
question and the nature of the dataset. This vignette provides a
practical framework, including a decision tree and illustrative case
studies, to guide researchers from their scientific question to an
appropriate metric.</p>
<div class="section level3">
<h3 id="a-decision-tree-for-metric-selection">A Decision Tree for Metric Selection<a class="anchor" aria-label="anchor" href="#a-decision-tree-for-metric-selection"></a>
</h3>
<p>This decision tree presents a series of questions to help a
researcher systematically narrow the field of 37 metrics to a small,
relevant subset.</p>
<div class="section level4">
<h4 id="do-you-have-a-reliable-phylogenetic-tree-relating-your-taxa-e-g--asvsotus">1. Do you have a reliable phylogenetic tree relating your taxa
(e.g., ASVs/OTUs)?<a class="anchor" aria-label="anchor" href="#do-you-have-a-reliable-phylogenetic-tree-relating-your-taxa-e-g--asvsotus"></a>
</h4>
<ul>
<li>
<p><strong>YES:</strong> Your analysis can and likely should
leverage phylogenetic information.</p>
<ul>
<li><p>Are you primarily interested in the presence/absence of entire
evolutionary lineages (e.g., detecting the invasion of a novel phylum)?
-&gt; Start with <u>Unweighted UniFrac</u>.</p></li>
<li><p>Are you primarily interested in shifts in the abundance of major,
well-established lineages (e.g., the Firmicutes/Bacteroidetes ratio)?
-&gt; Start with <u>Weighted UniFrac</u>.</p></li>
<li><p>Are you interested in a robust analysis that captures changes
across rare, moderate, and abundant lineages, or are you unsure? -&gt;
Use <u>Generalized UniFrac</u> (with α=0.5) as a powerful and balanced
primary choice. Consider using <u>Variance-Adjusted Weighted UniFrac</u>
for increased statistical power if you have uneven sample
sizes.</p></li>
</ul>
</li>
<li><p><strong>NO:</strong> You must use a Non-Phylogenetic Metric.
Proceed to Question 2.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="is-your-data-compositional-i-e--relative-abundances-from-high-throughput-sequencing">2. Is your data compositional (i.e., relative abundances from
high-throughput sequencing)?<a class="anchor" aria-label="anchor" href="#is-your-data-compositional-i-e--relative-abundances-from-high-throughput-sequencing"></a>
</h4>
<ul>
<li>
<p><strong>YES:</strong> You must account for the relative nature of
your data.</p>
<ul>
<li><p>The most statistically rigorous approach is to use a
compositional metric. -&gt; Your primary choice should be
<u>Aitchison</u> distance. Be prepared to handle zeros using a
pseudocount or other imputation method.</p></li>
<li><p>If you choose to use a non-compositional metric, select one that
is robust to transformations to proportions and less sensitive to
extreme values. -&gt; Good secondary choices include <u>Hellinger</u>,
<u>Jensen-Shannon Divergence</u>, or <u>Horn-Morisita</u>. Note that
these do not fully address the compositionality issue but are often
better behaved than Bray-Curtis or Euclidean on relative data.</p></li>
</ul>
</li>
<li><p><strong>NO:</strong> Your data represents absolute counts or
measurements (e.g., from microscopy or quantitative PCR). Proceed to
Question 3.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="what-is-the-primary-ecological-signal-you-want-to-detect">3. What is the primary ecological signal you want to detect?<a class="anchor" aria-label="anchor" href="#what-is-the-primary-ecological-signal-you-want-to-detect"></a>
</h4>
<ul>
<li>
<p>Presence/Absence of specific taxa (Community Membership): You are
interested in which species are present, regardless of their
abundance.</p>
<ul>
<li>-&gt; Choose a Qualitative (Binary) Metric. Your best options are
<u>Jaccard</u> (the standard for turnover) or <u>Dice-Sorensen</u>
(which gives more weight to shared species).</li>
</ul>
</li>
<li>
<p>Shifts in the abundance of taxa (Community Structure): You are
interested in which species are dominant and how their abundances
change.</p>
<ul>
<li>
<p>-&gt; Choose a Quantitative Metric.</p>
<ul>
<li><p>If you want a robust, widely understood standard that is
sensitive to dominant taxa -&gt; Use <u>Bray-Curtis</u>.</p></li>
<li><p>If your data consists of raw integer counts and you are concerned
about sample size effects -&gt; Use the <u>Morisita index</u>.</p></li>
<li><p>If you want to down-weight the influence of hyper-dominant
species for a more balanced view of abundance changes -&gt; Use the
<u>Hellinger distance</u>.</p></li>
<li><p>If you are concerned about small changes in very rare taxa being
amplified -&gt; Avoid the Canberra distance.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="case-studies-matching-metrics-to-microbiome-research-questions">Case Studies: Matching Metrics to Microbiome Research Questions<a class="anchor" aria-label="anchor" href="#case-studies-matching-metrics-to-microbiome-research-questions"></a>
</h3>
<p>The following case studies illustrate how the choice of metric
directly influences the ability to answer a specific biological
question.</p>
<div class="section level4">
<h4 id="case-study-1-does-antibiotic-treatment-eliminate-specific-rare-potentially-pathogenic-taxa">Case Study 1: Does antibiotic treatment eliminate specific rare,
potentially pathogenic taxa?<a class="anchor" aria-label="anchor" href="#case-study-1-does-antibiotic-treatment-eliminate-specific-rare-potentially-pathogenic-taxa"></a>
</h4>
<ul>
<li><p><strong>Research Question:</strong> This question is explicitly
about the presence or absence of key organisms, which are likely to be
rare in the overall community. The massive shifts in abundant, commensal
bacteria are secondary to the primary question of pathogen
eradication.</p></li>
<li><p><strong>Recommended Metric:</strong> <u>Jaccard</u> or
<u>Unweighted UniFrac</u>.</p></li>
<li><p><strong>Justification:</strong> A quantitative metric like
Bray-Curtis would be dominated by the large-scale disruption of dominant
taxa like Bacteroides or Faecalibacterium. The signal of the rare
pathogen’s disappearance could be completely lost. In contrast, a
qualitative metric like Jaccard treats the disappearance of the pathogen
(a change from 1 to 0) as a significant event, directly addressing the
research question. If a phylogenetic tree is available, Unweighted
UniFrac is even better, as it would capture the loss of an entire
evolutionary lineage, which might be more biologically meaningful than
the loss of a single ASV.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="case-study-2-how-does-a-high-fiber-vs--high-fat-diet-alter-the-overall-gut-microbiome-structure">Case Study 2: How does a high-fiber vs. high-fat diet alter the
overall gut microbiome structure?<a class="anchor" aria-label="anchor" href="#case-study-2-how-does-a-high-fiber-vs--high-fat-diet-alter-the-overall-gut-microbiome-structure"></a>
</h4>
<ul>
<li><p><strong>Research Question:</strong> This question concerns broad,
systemic shifts in the community’s metabolic capacity. The expected
signal is a change in the abundance of major functional guilds—for
example, an increase in fiber-degrading Firmicutes and a decrease in
bile-acid-metabolizing bacteria.</p></li>
<li><p><strong>Recommended Metrics:</strong> <u>Bray-Curtis</u> and
<u>Hellinger</u>.</p></li>
<li><p><strong>Justification:</strong> This question is about community
structure and the abundance of major players. Bray-Curtis is an
excellent choice as it is sensitive to these shifts in dominant and
abundant taxa. Using Hellinger as a complementary metric is a robust
strategy. The Hellinger distance, by using a square-root transformation,
will down-weight the influence of the most hyper-dominant taxa,
providing a slightly different and potentially more stable view of the
overall structural change. If both metrics show a significant difference
between diet groups, the conclusion is very strong.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="case-study-3-comparing-gut-communities-with-vastly-different-dominant-phyla-e-g--bacteroidetes-dominant-vs--firmicutes-dominant-">Case Study 3: Comparing gut communities with vastly different
dominant phyla (e.g., Bacteroidetes-dominant
vs. Firmicutes-dominant).<a class="anchor" aria-label="anchor" href="#case-study-3-comparing-gut-communities-with-vastly-different-dominant-phyla-e-g--bacteroidetes-dominant-vs--firmicutes-dominant-"></a>
</h4>
<ul>
<li><p><strong>Research Question:</strong> The goal is to understand
what other, more subtle structural differences exist between these two
community types, beyond the obvious phylum-level dominance. Are the
relative proportions of less abundant genera within the Proteobacteria
different, for example?</p></li>
<li><p><strong>Recommended Metric:</strong> <u>Aitchison
distance</u>.</p></li>
<li><p><strong>Justification:</strong> This is a classic
compositionality problem. In a Bray-Curtis analysis, the massive
difference in the abundance of Firmicutes vs. Bacteroidetes would create
such a large distance between the two sample types that all other
variation would be rendered invisible. The ordination plot would likely
show two tight, distant clusters, but reveal nothing about the internal
structure of those clusters. Aitchison distance, by using log-ratios,
effectively normalizes for the dominant phylum and calculates the
distance based on the relative proportions of all other taxa to one
another. This allows the researcher to “see through” the dominance
effect and investigate the more subtle structural differences that
directly address the research question.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="case-study-4-are-the-microbial-communities-in-two-soil-types-different-due-to-the-loss-of-a-deep-evolutionary-lineage-or-due-to-shifts-within-the-same-major-families">Case Study 4: Are the microbial communities in two soil types
different due to the loss of a deep evolutionary lineage or due to
shifts within the same major families?<a class="anchor" aria-label="anchor" href="#case-study-4-are-the-microbial-communities-in-two-soil-types-different-due-to-the-loss-of-a-deep-evolutionary-lineage-or-due-to-shifts-within-the-same-major-families"></a>
</h4>
<ul>
<li><p><strong>Research Question:</strong> This question is explicitly
phylogenetic and hierarchical. It seeks to distinguish between two
distinct types of evolutionary change.</p></li>
<li><p><strong>Recommended Metrics:</strong> <u>Generalized UniFrac
(GUniFrac)</u> with varying alpha values, and comparison of
<u>Unweighted and Weighted UniFrac</u>.</p></li>
<li><p><strong>Justification:</strong> A non-phylogenetic metric cannot
answer this question. The best approach is to use the GUniFrac
framework. The researcher would calculate the distance matrix using
multiple values of α (e.g., 0, 0.5, and 1). If the separation between
soil types is most significant when α=0 (Unweighted UniFrac), it
suggests the difference is driven by the presence/absence of entire
clades (a deep evolutionary change). If the separation is strongest when
α=1 (Weighted UniFrac), it suggests the difference is due to abundance
shifts within lineages that are present in both soils (a shallow
change). If the signal is strongest at α=0.5, it points to changes in
moderately abundant taxa as the key drivers, providing the most nuanced
answer.</p></li>
</ul>
<hr>
<p><small> Content generated by Google Gemini. Verified and formatted by
Daniel Smith. Sept. 5th, 2025. </small></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel P. Smith, Alkek Center for Metagenomics and Microbiome Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
