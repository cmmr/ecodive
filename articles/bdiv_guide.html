<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Selecting a Beta Diversity Metric • ecodive</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Noto_Sans-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Selecting a Beta Diversity Metric">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecodive</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/ecodive.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/adiv.html">Alpha Diversity</a></li>
    <li><a class="dropdown-item" href="../articles/bdiv_guide.html">Selecting a Beta Diversity Metric</a></li>
    <li><a class="dropdown-item" href="../articles/bdiv.html">Beta Diversity</a></li>
    <li><a class="dropdown-item" href="../articles/benchmark.html">Benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/performance.html">Performance Guide</a></li>
    <li><a class="dropdown-item" href="../articles/unifrac.html">UniFrac Calculations</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cmmr/ecodive/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Selecting a Beta Diversity Metric</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cmmr/ecodive/blob/main/vignettes/bdiv_guide.Rmd" class="external-link"><code>vignettes/bdiv_guide.Rmd</code></a></small>
      <div class="d-none name"><code>bdiv_guide.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="a-practical-guide-to-metric-selection-aligning-method-with-research-question">A Practical Guide to Metric Selection:<br>Aligning Method with
Research Question<a class="anchor" aria-label="anchor" href="#a-practical-guide-to-metric-selection-aligning-method-with-research-question"></a>
</h2>
<p>With dozens of ways to measure the difference between microbial
communities (beta diversity), choosing the “right” one can feel
overwhelming. Should you use UniFrac? Bray-Curtis? Aitchison?</p>
<p>The good news is that you don’t need to master the complex
mathematics behind every metric to make a robust choice. (Though if you
<em>do</em> want a deep dive into the theory, <strong><a href="https://doi.org/10.3389/fmicb.2017.02224" class="external-link">Gloor et
al. (2017)</a></strong> and <strong><a href="https://doi.org/10.3389/fmicb.2021.796025" class="external-link">Kers and Saccenti
(2022)</a></strong> offer excellent open-access reviews on data
compositionality and statistical power).</p>
<p>For most researchers, the process relies on just a few key
considerations. Instead of searching for a universally “perfect” metric,
your goal is to select the tool that best aligns with your specific data
properties and your biological hypothesis. This vignette cuts through
the noise to provide a practical decision tree and real-world case
studies, helping you match your statistical tools to your research
questions.</p>
<div class="section level3">
<h3 id="a-decision-tree-for-metric-selection">A Decision Tree for Metric Selection<a class="anchor" aria-label="anchor" href="#a-decision-tree-for-metric-selection"></a>
</h3>
<p>This decision tree presents a series of questions to help a
researcher systematically narrow the field of metrics to a small,
relevant subset.</p>
<div class="section level4">
<h4 id="do-you-have-a-reliable-phylogenetic-tree-relating-your-taxa-e-g--asvsotus">1. Do you have a reliable phylogenetic tree relating your taxa
(e.g., ASVs/OTUs)?<a class="anchor" aria-label="anchor" href="#do-you-have-a-reliable-phylogenetic-tree-relating-your-taxa-e-g--asvsotus"></a>
</h4>
<ul>
<li>
<p><strong>YES:</strong> Your analysis can and likely should
leverage phylogenetic information.</p>
<ul>
<li><p>Are you primarily interested in the presence/absence of entire
evolutionary lineages (e.g., detecting the invasion of a novel phylum)?
-&gt; Start with <u>Unweighted UniFrac</u>. As described by <strong><a href="https://doi.org/10.1128/aem.71.12.8228-8235.2005" class="external-link">Lozupone &amp;
Knight (2005)</a></strong>, this metric is qualitative (binary) and
measures the fraction of branch lengths unique to one community, making
it highly sensitive to community membership.</p></li>
<li><p>Are you primarily interested in shifts in the abundance of major,
well-established lineages (e.g., the Firmicutes/Bacteroidetes ratio)?
-&gt; Start with <u>Weighted UniFrac</u>. This metric weights branch
lengths by abundance, thereby emphasizing dominant taxa and minimizing
the noise from rare species.</p></li>
<li><p>Are you interested in a robust analysis that captures changes
across rare, moderate, and abundant lineages? -&gt; Use <u>Generalized
UniFrac</u>. Simulation studies by <strong><a href="https://doi.org/10.1093/bioinformatics/bts342" class="external-link">Chen &amp; Li
(2012)</a></strong> demonstrate that Generalized UniFrac often provides
more power to detect changes in moderately abundant taxa than either
Unweighted or Weighted UniFrac alone.</p></li>
</ul>
</li>
<li><p><strong>NO:</strong> You must use a Non-Phylogenetic Metric.
Proceed to Question 2.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="is-your-data-compositional-i-e--relative-abundances-from-high-throughput-sequencing">2. Is your data compositional (i.e., relative abundances from
high-throughput sequencing)?<a class="anchor" aria-label="anchor" href="#is-your-data-compositional-i-e--relative-abundances-from-high-throughput-sequencing"></a>
</h4>
<ul>
<li>
<p><strong>YES:</strong> You must account for the relative nature of
your data (the “constant sum” constraint).</p>
<ul>
<li><p>The most statistically rigorous approach is to use a
compositional metric. -&gt; Your primary choice should be
<u>Aitchison</u> distance (Euclidean distance on Centered Log-Ratio
transformed data). <strong><a href="https://doi.org/10.3389/fmicb.2017.02224" class="external-link">Gloor et
al. (2017)</a></strong> argue this approach is essential to avoid
spurious correlations and “false positives” common in standard
ecological metrics when applied to relative abundance data.</p></li>
<li><p>If you choose to use a non-compositional metric, select one that
is robust to sparsity. -&gt; Good secondary choices include
<u>Hellinger</u> or <u>Jensen-Shannon Divergence (JSD)</u>. In a
rigorous benchmarking of 13 metrics on high-dimensional data, <strong><a href="https://doi.org/10.1371/journal.pone.0246893" class="external-link">Chen et
al. (2021)</a></strong> demonstrated that Hellinger and JSD captured
compositional changes in low-abundance elements more efficiently than
other standard metrics. Similarly, <strong><a href="https://academic.oup.com/ismecommun/article/5/1/ycaf230/8373278" class="external-link">Cordier
et al. (2024)</a></strong> found Hellinger to be one of the top
performers in handling noisy, sparse count data.</p></li>
</ul>
</li>
<li><p><strong>NO:</strong> Your data represents absolute counts or
measurements (e.g., from microscopy or quantitative PCR). Proceed to
Question 3.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="what-is-the-primary-ecological-signal-you-want-to-detect">3. What is the primary ecological signal you want to detect?<a class="anchor" aria-label="anchor" href="#what-is-the-primary-ecological-signal-you-want-to-detect"></a>
</h4>
<ul>
<li>
<p>Presence/Absence of specific taxa (Community Membership): You are
interested in which species are present, regardless of their
abundance.</p>
<ul>
<li>-&gt; Choose a Qualitative (Binary) Metric. Your best options are
<u>Jaccard</u> (the standard for turnover) or <u>Sorensen-Dice</u>.
<strong><a href="https://doi.org/10.3389/fmicb.2021.796025" class="external-link">Kers and
Saccenti (2022)</a></strong> confirm that beta diversity metrics
focusing on membership can reveal differences that abundance-weighted
metrics miss. <strong>Note:</strong> Be cautious if your sampling depth
is low; <strong><a href="https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.2100" class="external-link">Schroeder
et al. (2018)</a></strong> warn that richness-based metrics like Jaccard
are highly sensitive to undersampling error.</li>
</ul>
</li>
<li>
<p>Shifts in the abundance of taxa (Community Structure): You are
interested in which species are dominant and how their abundances
change.</p>
<ul>
<li>
<p>-&gt; Choose a Quantitative Metric.</p>
<ul>
<li><p>If you want a robust, widely understood standard that is
sensitive to dominant taxa -&gt; Use <u>Bray-Curtis</u>. <strong><a href="https://doi.org/10.3389/fmicb.2021.796025" class="external-link">Kers and Saccenti
(2022)</a></strong> found Bray-Curtis to be generally the most sensitive
metric for observing differences between groups.</p></li>
<li><p>If you want to down-weight the influence of hyper-dominant
species -&gt; Use the <u>Hellinger distance</u>. As noted by <strong><a href="https://doi.org/10.1371/journal.pone.0246893" class="external-link">Chen et
al. (2021)</a></strong>, this metric effectively balances the signal
between dominant and rare taxa, avoiding the skew common in raw
abundance metrics.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="case-studies-matching-metrics-to-microbiome-research-questions">Case Studies: Matching Metrics to Microbiome Research Questions<a class="anchor" aria-label="anchor" href="#case-studies-matching-metrics-to-microbiome-research-questions"></a>
</h3>
<p>The following case studies illustrate how the choice of metric
directly influences the ability to answer a specific biological
question.</p>
<div class="section level4">
<h4 id="case-study-1-does-antibiotic-treatment-eliminate-specific-rare-potentially-pathogenic-taxa">Case Study 1: Does antibiotic treatment eliminate specific rare,
potentially pathogenic taxa?<a class="anchor" aria-label="anchor" href="#case-study-1-does-antibiotic-treatment-eliminate-specific-rare-potentially-pathogenic-taxa"></a>
</h4>
<ul>
<li><p><strong>Research Question:</strong> This question is explicitly
about the presence or absence of key organisms (membership). The massive
shifts in abundant commensal bacteria are secondary.</p></li>
<li><p><strong>Recommended Metric:</strong> <u>Jaccard</u> or
<u>Unweighted UniFrac</u>.</p></li>
<li><p><strong>Justification:</strong> A quantitative metric like
Bray-Curtis would be dominated by the large-scale disruption of dominant
taxa. The signal of the rare pathogen’s disappearance could be lost. As
demonstrated by <strong><a href="https://doi.org/10.1128/aem.71.12.8228-8235.2005" class="external-link">Lozupone &amp;
Knight (2005)</a></strong>, Unweighted UniFrac treats the unique
evolutionary history of the pathogen as a significant event, directly
addressing the research question.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="case-study-2-how-does-a-high-fiber-vs--high-fat-diet-alter-the-overall-gut-microbiome-structure">Case Study 2: How does a high-fiber vs. high-fat diet alter the
overall gut microbiome structure?<a class="anchor" aria-label="anchor" href="#case-study-2-how-does-a-high-fiber-vs--high-fat-diet-alter-the-overall-gut-microbiome-structure"></a>
</h4>
<ul>
<li><p><strong>Research Question:</strong> This question concerns broad,
systemic shifts in the community’s metabolic capacity (abundance of
major guilds).</p></li>
<li><p><strong>Recommended Metrics:</strong> <u>Bray-Curtis</u> and
<u>Hellinger</u>.</p></li>
<li><p><strong>Justification:</strong> Bray-Curtis is sensitive to
shifts in dominant taxa. However, <strong><a href="https://doi.org/10.3389/fmicb.2021.796025" class="external-link">Kers and Saccenti
(2022)</a></strong> recommend checking results across multiple metrics
to ensure robustness. <strong><a href="https://doi.org/10.1371/journal.pone.0246893" class="external-link">Chen et
al. (2021)</a></strong> specifically highlight Hellinger’s ability to
handle the sparsity and skew of microbiome data better than simple
Euclidean distances.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="case-study-3-comparing-gut-communities-with-vastly-different-dominant-phyla-e-g--bacteroidetes-dominant-vs--firmicutes-dominant-">Case Study 3: Comparing gut communities with vastly different
dominant phyla (e.g., Bacteroidetes-dominant
vs. Firmicutes-dominant).<a class="anchor" aria-label="anchor" href="#case-study-3-comparing-gut-communities-with-vastly-different-dominant-phyla-e-g--bacteroidetes-dominant-vs--firmicutes-dominant-"></a>
</h4>
<ul>
<li><p><strong>Research Question:</strong> The goal is to understand
structural differences beyond the obvious phylum-level
dominance.</p></li>
<li><p><strong>Recommended Metric:</strong> <u>Aitchison
distance</u>.</p></li>
<li><p><strong>Justification:</strong> This is a compositionality
problem. In a Bray-Curtis analysis, the massive difference in the
dominant phylum would obscure all other variation. <strong><a href="https://doi.org/10.3389/fmicb.2017.02224" class="external-link">Gloor et
al. (2017)</a></strong> demonstrate that Aitchison distance uses
log-ratios to normalize for the dominant components, allowing the
researcher to investigate the “sub-compositional” structure.</p></li>
</ul>
<hr>
<p><small> Content generated by Google Gemini. Verified and formatted by
Daniel Smith. January 27th, 2026. </small></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel P. Smith, Alkek Center for Metagenomics and Microbiome Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
